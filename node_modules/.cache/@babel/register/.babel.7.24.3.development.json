{"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst session = require('express-session');\nconst dotenv = require('dotenv');\nconst morgan = require('morgan');\nconst cors = require('cors');\nconst cookieParser = require('cookie-parser');\nconst bodyParser = require('body-parser');\nconst path = require('path');\nconst mongoose = require('mongoose');\nconst favicon = require('express-favicon');\nconst methodOverride = require('method-override');\nconst cron = require('node-cron');\nconst app = express();\nconst port = 3000;\nconst corsOptions = {\n  origin: 'http://localhost:6002',\n  methods: ['GET', 'POST', 'PUT'],\n  allowedHeaders: ['Content-Type', 'Authorization']\n};\napp.use(cors(corsOptions));\ndotenv.config();\napp.use(session({\n  secret: 'giangtt653',\n  resave: false,\n  saveUninitialized: true\n}));\napp.use(favicon(__dirname + '/public/favicon.ico'));\napp.use(express.static(path.join(__dirname, 'public')));\nmongoose.connect(process.env.MONGO_URL).then(() => {\n  console.log('Db connected');\n}).catch(err => console.log(err));\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\napp.use(bodyParser.json());\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: true\n}));\napp.use(methodOverride('_method'));\n\n//ghi log các yêu cầu HTTP\napp.use(morgan('dev'));\n\n// ghi log cookie\napp.use(cookieParser());\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'ejs');\n\n// console.log(\"Views directory:\", app.get('views'));\n\napp.get('/nft', (req, res) => {\n  res.render('blockchain/nft');\n});\nconst authRouter = require('./routes/auth');\nconst categoryRouter = require('./routes/category');\nconst questionRouter = require('./routes/question');\nconst testRouter = require('./routes/test');\nconst nftRouter = require('./routes/nft');\n\n//api o fday\nconst apiAuthRouter = require('./routes/api/api.auth');\nconst apiTestRouter = require('./routes/api/api.testt');\nconst apiScoreRouter = require('./routes/api/api.score');\nconst apiRankRouter = require('./routes/api/api.rank');\nconst apiCapchaRouter = require('./routes/api/api.capcha');\nconst apiHelpRouter = require('./routes/api/api.help');\napp.use('/', authRouter);\napp.use('/category', categoryRouter);\napp.use('/question', questionRouter);\napp.use('/test', testRouter);\napp.use('/nft', nftRouter);\n\n//api o fday\napp.use('/api', apiAuthRouter);\napp.use('/api/quizz', apiTestRouter);\napp.use('/api/score', apiScoreRouter);\napp.use('/api/rank', apiRankRouter);\napp.use('/api/capcha', apiCapchaRouter);\napp.use('/api/help', apiHelpRouter);\napp.listen(process.env.PORT || port, () => console.log(`Server listening on ${process.env.PORT}!`));\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInNlc3Npb24iLCJkb3RlbnYiLCJtb3JnYW4iLCJjb3JzIiwiY29va2llUGFyc2VyIiwiYm9keVBhcnNlciIsInBhdGgiLCJtb25nb29zZSIsImZhdmljb24iLCJtZXRob2RPdmVycmlkZSIsImNyb24iLCJhcHAiLCJwb3J0IiwiY29yc09wdGlvbnMiLCJvcmlnaW4iLCJtZXRob2RzIiwiYWxsb3dlZEhlYWRlcnMiLCJ1c2UiLCJjb25maWciLCJzZWNyZXQiLCJyZXNhdmUiLCJzYXZlVW5pbml0aWFsaXplZCIsIl9fZGlybmFtZSIsInN0YXRpYyIsImpvaW4iLCJjb25uZWN0IiwicHJvY2VzcyIsImVudiIsIk1PTkdPX1VSTCIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnIiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJqc29uIiwic2V0IiwiZ2V0IiwicmVxIiwicmVzIiwicmVuZGVyIiwiYXV0aFJvdXRlciIsImNhdGVnb3J5Um91dGVyIiwicXVlc3Rpb25Sb3V0ZXIiLCJ0ZXN0Um91dGVyIiwibmZ0Um91dGVyIiwiYXBpQXV0aFJvdXRlciIsImFwaVRlc3RSb3V0ZXIiLCJhcGlTY29yZVJvdXRlciIsImFwaVJhbmtSb3V0ZXIiLCJhcGlDYXBjaGFSb3V0ZXIiLCJhcGlIZWxwUm91dGVyIiwibGlzdGVuIiwiUE9SVCJdLCJzb3VyY2VSb290IjoiRzpcXFRUVE5fU1AyNF9TRVJWRVJcXCIsInNvdXJjZXMiOlsic2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHNlc3Npb24gPSByZXF1aXJlKCdleHByZXNzLXNlc3Npb24nKTtcclxuY29uc3QgZG90ZW52ID0gcmVxdWlyZSgnZG90ZW52Jyk7XHJcbmNvbnN0IG1vcmdhbiA9IHJlcXVpcmUoJ21vcmdhbicpO1xyXG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xyXG5jb25zdCBjb29raWVQYXJzZXIgPSByZXF1aXJlKCdjb29raWUtcGFyc2VyJyk7XHJcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5jb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcbmNvbnN0IGZhdmljb24gPSByZXF1aXJlKCdleHByZXNzLWZhdmljb24nKTtcclxuY29uc3QgbWV0aG9kT3ZlcnJpZGUgPSByZXF1aXJlKCdtZXRob2Qtb3ZlcnJpZGUnKTtcclxuY29uc3QgY3JvbiA9IHJlcXVpcmUoJ25vZGUtY3JvbicpO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5jb25zdCBwb3J0ID0gMzAwMDtcclxuXHJcbmNvbnN0IGNvcnNPcHRpb25zID0ge1xyXG4gICAgb3JpZ2luOiAnaHR0cDovL2xvY2FsaG9zdDo2MDAyJyxcclxuICAgIG1ldGhvZHM6IFsnR0VUJywgJ1BPU1QnLCAnUFVUJ10sXHJcbiAgICBhbGxvd2VkSGVhZGVyczogWydDb250ZW50LVR5cGUnLCAnQXV0aG9yaXphdGlvbiddLFxyXG59O1xyXG5cclxuYXBwLnVzZShjb3JzKGNvcnNPcHRpb25zKSk7XHJcblxyXG5cclxuZG90ZW52LmNvbmZpZygpO1xyXG5cclxuYXBwLnVzZShzZXNzaW9uKHtcclxuICAgIHNlY3JldDogJ2dpYW5ndHQ2NTMnLFxyXG4gICAgcmVzYXZlOiBmYWxzZSxcclxuICAgIHNhdmVVbmluaXRpYWxpemVkOiB0cnVlXHJcbn0pKTtcclxuXHJcbmFwcC51c2UoZmF2aWNvbihfX2Rpcm5hbWUgKyAnL3B1YmxpYy9mYXZpY29uLmljbycpKTtcclxuXHJcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgJ3B1YmxpYycpKSk7XHJcblxyXG5cclxubW9uZ29vc2UuY29ubmVjdChwcm9jZXNzLmVudi5NT05HT19VUkwpLnRoZW4oKCk9PntcclxuICAgIGNvbnNvbGUubG9nKCdEYiBjb25uZWN0ZWQnKVxyXG59KS5jYXRjaCgoZXJyKT0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpO1xyXG5cclxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XHJcbmFwcC51c2UoZXhwcmVzcy51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpO1xyXG5cclxuYXBwLnVzZShtZXRob2RPdmVycmlkZSgnX21ldGhvZCcpKTtcclxuXHJcbi8vZ2hpIGxvZyBjw6FjIHnDqnUgY+G6p3UgSFRUUFxyXG5hcHAudXNlKG1vcmdhbignZGV2JykpO1xyXG5cclxuLy8gZ2hpIGxvZyBjb29raWVcclxuYXBwLnVzZShjb29raWVQYXJzZXIoKSk7XHJcblxyXG5hcHAuc2V0KCd2aWV3cycsIHBhdGguam9pbihfX2Rpcm5hbWUsICd2aWV3cycpKTtcclxuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnZWpzJyk7XHJcblxyXG4vLyBjb25zb2xlLmxvZyhcIlZpZXdzIGRpcmVjdG9yeTpcIiwgYXBwLmdldCgndmlld3MnKSk7XHJcblxyXG5hcHAuZ2V0KCcvbmZ0JywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICByZXMucmVuZGVyKCdibG9ja2NoYWluL25mdCcpO1xyXG59KTtcclxuXHJcbmNvbnN0IGF1dGhSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlcy9hdXRoJyk7XHJcbmNvbnN0IGNhdGVnb3J5Um91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXMvY2F0ZWdvcnknKTtcclxuY29uc3QgcXVlc3Rpb25Sb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlcy9xdWVzdGlvbicpO1xyXG5jb25zdCB0ZXN0Um91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXMvdGVzdCcpO1xyXG5jb25zdCBuZnRSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlcy9uZnQnKTtcclxuXHJcblxyXG4vL2FwaSBvIGZkYXlcclxuY29uc3QgYXBpQXV0aFJvdXRlciA9IHJlcXVpcmUoJy4vcm91dGVzL2FwaS9hcGkuYXV0aCcpO1xyXG5jb25zdCBhcGlUZXN0Um91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXMvYXBpL2FwaS50ZXN0dCcpO1xyXG5jb25zdCBhcGlTY29yZVJvdXRlciA9IHJlcXVpcmUoJy4vcm91dGVzL2FwaS9hcGkuc2NvcmUnKTtcclxuY29uc3QgYXBpUmFua1JvdXRlciA9IHJlcXVpcmUoJy4vcm91dGVzL2FwaS9hcGkucmFuaycpO1xyXG5jb25zdCBhcGlDYXBjaGFSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlcy9hcGkvYXBpLmNhcGNoYScpO1xyXG5jb25zdCBhcGlIZWxwUm91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXMvYXBpL2FwaS5oZWxwJyk7XHJcblxyXG5hcHAudXNlKCcvJywgYXV0aFJvdXRlcik7XHJcbmFwcC51c2UoJy9jYXRlZ29yeScsIGNhdGVnb3J5Um91dGVyKTtcclxuYXBwLnVzZSgnL3F1ZXN0aW9uJywgcXVlc3Rpb25Sb3V0ZXIpO1xyXG5hcHAudXNlKCcvdGVzdCcsIHRlc3RSb3V0ZXIpO1xyXG5hcHAudXNlKCcvbmZ0JywgbmZ0Um91dGVyKTtcclxuXHJcbi8vYXBpIG8gZmRheVxyXG5hcHAudXNlKCcvYXBpJywgYXBpQXV0aFJvdXRlcik7XHJcbmFwcC51c2UoJy9hcGkvcXVpenonLCBhcGlUZXN0Um91dGVyKTtcclxuYXBwLnVzZSgnL2FwaS9zY29yZScsIGFwaVNjb3JlUm91dGVyKTtcclxuYXBwLnVzZSgnL2FwaS9yYW5rJywgYXBpUmFua1JvdXRlcik7XHJcbmFwcC51c2UoJy9hcGkvY2FwY2hhJywgYXBpQ2FwY2hhUm91dGVyKTtcclxuYXBwLnVzZSgnL2FwaS9oZWxwJywgYXBpSGVscFJvdXRlcik7XHJcblxyXG5hcHAubGlzdGVuKHByb2Nlc3MuZW52LlBPUlQgfHwgcG9ydCwgKCkgPT4gY29uc29sZS5sb2coYFNlcnZlciBsaXN0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","map":{"version":3,"names":["express","require","session","dotenv","morgan","cors","cookieParser","bodyParser","path","mongoose","favicon","methodOverride","cron","app","port","corsOptions","origin","methods","allowedHeaders","use","config","secret","resave","saveUninitialized","__dirname","static","join","connect","process","env","MONGO_URL","then","console","log","catch","err","urlencoded","extended","json","set","get","req","res","render","authRouter","categoryRouter","questionRouter","testRouter","nftRouter","apiAuthRouter","apiTestRouter","apiScoreRouter","apiRankRouter","apiCapchaRouter","apiHelpRouter","listen","PORT"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\","sources":["server.js"],"sourcesContent":["const express = require('express');\r\nconst session = require('express-session');\r\nconst dotenv = require('dotenv');\r\nconst morgan = require('morgan');\r\nconst cors = require('cors');\r\nconst cookieParser = require('cookie-parser');\r\nconst bodyParser = require('body-parser');\r\nconst path = require('path');\r\nconst mongoose = require('mongoose');\r\nconst favicon = require('express-favicon');\r\nconst methodOverride = require('method-override');\r\nconst cron = require('node-cron');\r\n\r\nconst app = express();\r\nconst port = 3000;\r\n\r\nconst corsOptions = {\r\n    origin: 'http://localhost:6002',\r\n    methods: ['GET', 'POST', 'PUT'],\r\n    allowedHeaders: ['Content-Type', 'Authorization'],\r\n};\r\n\r\napp.use(cors(corsOptions));\r\n\r\n\r\ndotenv.config();\r\n\r\napp.use(session({\r\n    secret: 'giangtt653',\r\n    resave: false,\r\n    saveUninitialized: true\r\n}));\r\n\r\napp.use(favicon(__dirname + '/public/favicon.ico'));\r\n\r\napp.use(express.static(path.join(__dirname, 'public')));\r\n\r\n\r\nmongoose.connect(process.env.MONGO_URL).then(()=>{\r\n    console.log('Db connected')\r\n}).catch((err)=> console.log(err));\r\n\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\napp.use(bodyParser.json());\r\n\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\napp.use(methodOverride('_method'));\r\n\r\n//ghi log các yêu cầu HTTP\r\napp.use(morgan('dev'));\r\n\r\n// ghi log cookie\r\napp.use(cookieParser());\r\n\r\napp.set('views', path.join(__dirname, 'views'));\r\napp.set('view engine', 'ejs');\r\n\r\n// console.log(\"Views directory:\", app.get('views'));\r\n\r\napp.get('/nft', (req, res) => {\r\n    res.render('blockchain/nft');\r\n});\r\n\r\nconst authRouter = require('./routes/auth');\r\nconst categoryRouter = require('./routes/category');\r\nconst questionRouter = require('./routes/question');\r\nconst testRouter = require('./routes/test');\r\nconst nftRouter = require('./routes/nft');\r\n\r\n\r\n//api o fday\r\nconst apiAuthRouter = require('./routes/api/api.auth');\r\nconst apiTestRouter = require('./routes/api/api.testt');\r\nconst apiScoreRouter = require('./routes/api/api.score');\r\nconst apiRankRouter = require('./routes/api/api.rank');\r\nconst apiCapchaRouter = require('./routes/api/api.capcha');\r\nconst apiHelpRouter = require('./routes/api/api.help');\r\n\r\napp.use('/', authRouter);\r\napp.use('/category', categoryRouter);\r\napp.use('/question', questionRouter);\r\napp.use('/test', testRouter);\r\napp.use('/nft', nftRouter);\r\n\r\n//api o fday\r\napp.use('/api', apiAuthRouter);\r\napp.use('/api/quizz', apiTestRouter);\r\napp.use('/api/score', apiScoreRouter);\r\napp.use('/api/rank', apiRankRouter);\r\napp.use('/api/capcha', apiCapchaRouter);\r\napp.use('/api/help', apiHelpRouter);\r\n\r\napp.listen(process.env.PORT || port, () => console.log(`Server listening on ${process.env.PORT}!`));\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1711640286132},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\auth.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\nconst authController = require('../controllers/authController');\nrouter.post('/signup', authController.createUser);\nrouter.get('/login', authController.loginUser);\nrouter.post('/login', authController.loginUser);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInNlc3Npb25NaWRkbGV3YXJlIiwiYXV0aENvbnRyb2xsZXIiLCJwb3N0IiwiY3JlYXRlVXNlciIsImdldCIsImxvZ2luVXNlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxyb3V0ZXNcXCIsInNvdXJjZXMiOlsiYXV0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG5jb25zdCBzZXNzaW9uTWlkZGxld2FyZSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvc2Vzc2lvbk1pZGRsZXdhcmUnKTsgXHJcbmNvbnN0IGF1dGhDb250cm9sbGVyID0gcmVxdWlyZSgnLi4vY29udHJvbGxlcnMvYXV0aENvbnRyb2xsZXInKTtcclxuXHJcbnJvdXRlci5wb3N0KCcvc2lnbnVwJywgYXV0aENvbnRyb2xsZXIuY3JlYXRlVXNlcik7XHJcblxyXG5yb3V0ZXIuZ2V0KCcvbG9naW4nLCBhdXRoQ29udHJvbGxlci5sb2dpblVzZXIpO1xyXG5yb3V0ZXIucG9zdCgnL2xvZ2luJywgYXV0aENvbnRyb2xsZXIubG9naW5Vc2VyKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsaUJBQWlCLEdBQUdILE9BQU8sQ0FBQyxpQ0FBaUMsQ0FBQztBQUNwRSxNQUFNSSxjQUFjLEdBQUdKLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQztBQUUvREMsTUFBTSxDQUFDSSxJQUFJLENBQUMsU0FBUyxFQUFFRCxjQUFjLENBQUNFLFVBQVUsQ0FBQztBQUVqREwsTUFBTSxDQUFDTSxHQUFHLENBQUMsUUFBUSxFQUFFSCxjQUFjLENBQUNJLFNBQVMsQ0FBQztBQUM5Q1AsTUFBTSxDQUFDSSxJQUFJLENBQUMsUUFBUSxFQUFFRCxjQUFjLENBQUNJLFNBQVMsQ0FBQztBQUUvQ0MsTUFBTSxDQUFDQyxPQUFPLEdBQUdULE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","sessionMiddleware","authController","post","createUser","get","loginUser","module","exports"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\routes\\","sources":["auth.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst sessionMiddleware = require('../middleware/sessionMiddleware'); \r\nconst authController = require('../controllers/authController');\r\n\r\nrouter.post('/signup', authController.createUser);\r\n\r\nrouter.get('/login', authController.loginUser);\r\nrouter.post('/login', authController.loginUser);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,iBAAiB,GAAGH,OAAO,CAAC,iCAAiC,CAAC;AACpE,MAAMI,cAAc,GAAGJ,OAAO,CAAC,+BAA+B,CAAC;AAE/DC,MAAM,CAACI,IAAI,CAAC,SAAS,EAAED,cAAc,CAACE,UAAU,CAAC;AAEjDL,MAAM,CAACM,GAAG,CAAC,QAAQ,EAAEH,cAAc,CAACI,SAAS,CAAC;AAC9CP,MAAM,CAACI,IAAI,CAAC,QAAQ,EAAED,cAAc,CAACI,SAAS,CAAC;AAE/CC,MAAM,CAACC,OAAO,GAAGT,MAAM","ignoreList":[]}},"mtime":1710065164401},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\middleware\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\middleware\\\\sessionMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const User = require('../models/User');\nconst jwt = require('jsonwebtoken');\nconst sessionMiddleware = async (req, res, next) => {\n  try {\n    if (req.session && req.session.user) {\n      next();\n    } else {\n      const token = req.headers.authorization;\n      if (!token) {\n        return res.status(401).json({\n          error: 'Unauthorized'\n        });\n      }\n      const decoded = jwt.verify(token, process.env.JWT_SEC);\n      const user = await User.findById(decoded.userId);\n      if (!user) {\n        return res.status(401).json({\n          error: 'User not found'\n        });\n      }\n      req.session.user = user;\n      next();\n    }\n  } catch (error) {\n    console.error(error);\n    res.status(500).json({\n      error: 'Internal Server Error'\n    });\n  }\n};\nmodule.exports = sessionMiddleware;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImp3dCIsInNlc3Npb25NaWRkbGV3YXJlIiwicmVxIiwicmVzIiwibmV4dCIsInNlc3Npb24iLCJ1c2VyIiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImRlY29kZWQiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQyIsImZpbmRCeUlkIiwidXNlcklkIiwiY29uc29sZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxtaWRkbGV3YXJlXFwiLCJzb3VyY2VzIjpbInNlc3Npb25NaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvVXNlcicpO1xyXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcclxuXHJcbmNvbnN0IHNlc3Npb25NaWRkbGV3YXJlID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmIChyZXEuc2Vzc2lvbiAmJiByZXEuc2Vzc2lvbi51c2VyKSB7XHJcbiAgICAgIG5leHQoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuXHJcbiAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDKTtcclxuXHJcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKGRlY29kZWQudXNlcklkKTtcclxuXHJcbiAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnVXNlciBub3QgZm91bmQnIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXEuc2Vzc2lvbi51c2VyID0gdXNlcjtcclxuXHJcbiAgICAgIG5leHQoKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyB9KTtcclxuICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHNlc3Npb25NaWRkbGV3YXJlO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQ3RDLE1BQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUVuQyxNQUFNRSxpQkFBaUIsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQ2xELElBQUk7SUFDRixJQUFJRixHQUFHLENBQUNHLE9BQU8sSUFBSUgsR0FBRyxDQUFDRyxPQUFPLENBQUNDLElBQUksRUFBRTtNQUNuQ0YsSUFBSSxDQUFDLENBQUM7SUFDUixDQUFDLE1BQU07TUFDTCxNQUFNRyxLQUFLLEdBQUdMLEdBQUcsQ0FBQ00sT0FBTyxDQUFDQyxhQUFhO01BRXZDLElBQUksQ0FBQ0YsS0FBSyxFQUFFO1FBQ1YsT0FBT0osR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztVQUFFQyxLQUFLLEVBQUU7UUFBZSxDQUFDLENBQUM7TUFDeEQ7TUFFQSxNQUFNQyxPQUFPLEdBQUdiLEdBQUcsQ0FBQ2MsTUFBTSxDQUFDUCxLQUFLLEVBQUVRLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxPQUFPLENBQUM7TUFFdEQsTUFBTVgsSUFBSSxHQUFHLE1BQU1SLElBQUksQ0FBQ29CLFFBQVEsQ0FBQ0wsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFFaEQsSUFBSSxDQUFDYixJQUFJLEVBQUU7UUFDVCxPQUFPSCxHQUFHLENBQUNPLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1VBQUVDLEtBQUssRUFBRTtRQUFpQixDQUFDLENBQUM7TUFDMUQ7TUFFQVYsR0FBRyxDQUFDRyxPQUFPLENBQUNDLElBQUksR0FBR0EsSUFBSTtNQUV2QkYsSUFBSSxDQUFDLENBQUM7SUFDUjtFQUNGLENBQUMsQ0FBQyxPQUFPUSxLQUFLLEVBQUU7SUFDZFEsT0FBTyxDQUFDUixLQUFLLENBQUNBLEtBQUssQ0FBQztJQUNwQlQsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUFFQyxLQUFLLEVBQUU7SUFBd0IsQ0FBQyxDQUFDO0VBQzFEO0FBQ0YsQ0FBQztBQUVEUyxNQUFNLENBQUNDLE9BQU8sR0FBR3JCLGlCQUFpQiIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["User","require","jwt","sessionMiddleware","req","res","next","session","user","token","headers","authorization","status","json","error","decoded","verify","process","env","JWT_SEC","findById","userId","console","module","exports"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\middleware\\","sources":["sessionMiddleware.js"],"sourcesContent":["const User = require('../models/User');\r\nconst jwt = require('jsonwebtoken');\r\n\r\nconst sessionMiddleware = async (req, res, next) => {\r\n  try {\r\n    if (req.session && req.session.user) {\r\n      next();\r\n    } else {\r\n      const token = req.headers.authorization;\r\n\r\n      if (!token) {\r\n        return res.status(401).json({ error: 'Unauthorized' });\r\n      }\r\n\r\n      const decoded = jwt.verify(token, process.env.JWT_SEC);\r\n\r\n      const user = await User.findById(decoded.userId);\r\n\r\n      if (!user) {\r\n        return res.status(401).json({ error: 'User not found' });\r\n      }\r\n\r\n      req.session.user = user;\r\n\r\n      next();\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n    res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n};\r\n\r\nmodule.exports = sessionMiddleware;\r\n"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,gBAAgB,CAAC;AACtC,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAc,CAAC;AAEnC,MAAME,iBAAiB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAClD,IAAI;IACF,IAAIF,GAAG,CAACG,OAAO,IAAIH,GAAG,CAACG,OAAO,CAACC,IAAI,EAAE;MACnCF,IAAI,CAAC,CAAC;IACR,CAAC,MAAM;MACL,MAAMG,KAAK,GAAGL,GAAG,CAACM,OAAO,CAACC,aAAa;MAEvC,IAAI,CAACF,KAAK,EAAE;QACV,OAAOJ,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,KAAK,EAAE;QAAe,CAAC,CAAC;MACxD;MAEA,MAAMC,OAAO,GAAGb,GAAG,CAACc,MAAM,CAACP,KAAK,EAAEQ,OAAO,CAACC,GAAG,CAACC,OAAO,CAAC;MAEtD,MAAMX,IAAI,GAAG,MAAMR,IAAI,CAACoB,QAAQ,CAACL,OAAO,CAACM,MAAM,CAAC;MAEhD,IAAI,CAACb,IAAI,EAAE;QACT,OAAOH,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,KAAK,EAAE;QAAiB,CAAC,CAAC;MAC1D;MAEAV,GAAG,CAACG,OAAO,CAACC,IAAI,GAAGA,IAAI;MAEvBF,IAAI,CAAC,CAAC;IACR;EACF,CAAC,CAAC,OAAOQ,KAAK,EAAE;IACdQ,OAAO,CAACR,KAAK,CAACA,KAAK,CAAC;IACpBT,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,KAAK,EAAE;IAAwB,CAAC,CAAC;EAC1D;AACF,CAAC;AAEDS,MAAM,CAACC,OAAO,GAAGrB,iBAAiB","ignoreList":[]}},"mtime":1709959231595},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const mongoose = require('mongoose');\nconst UserSchema = new mongoose.Schema({\n  username: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  avatar: {\n    type: String\n  },\n  solanaAddress: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  role: {\n    type: String,\n    enum: ['staff', 'admin'],\n    default: 'staff'\n  }\n});\nmodule.exports = mongoose.model('User', UserSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJVc2VyU2NoZW1hIiwiU2NoZW1hIiwidXNlcm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJ1bmlxdWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiYXZhdGFyIiwic29sYW5hQWRkcmVzcyIsInJvbGUiLCJlbnVtIiwiZGVmYXVsdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiRzpcXFRUVE5fU1AyNF9TRVJWRVJcXG1vZGVsc1xcIiwic291cmNlcyI6WyJVc2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuXHJcbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICB1c2VybmFtZToge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICB1bmlxdWU6IHRydWUsXHJcbiAgfSxcclxuICBlbWFpbDoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICB1bmlxdWU6IHRydWUsXHJcbiAgfSxcclxuICBwYXNzd29yZDoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfSxcclxuICBhdmF0YXI6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICB9LFxyXG4gIHNvbGFuYUFkZHJlc3M6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgdW5pcXVlOiB0cnVlLFxyXG4gIH0sXHJcbiAgcm9sZToge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgZW51bTogWydzdGFmZicsICdhZG1pbiddLFxyXG4gICAgZGVmYXVsdDogJ3N0YWZmJyxcclxuICB9LFxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoJ1VzZXInLCBVc2VyU2NoZW1hKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFcEMsTUFBTUMsVUFBVSxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBTSxDQUFDO0VBQ3JDQyxRQUFRLEVBQUU7SUFDUkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLFFBQVEsRUFBRSxJQUFJO0lBQ2RDLE1BQU0sRUFBRTtFQUNWLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xKLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxNQUFNLEVBQUU7RUFDVixDQUFDO0VBQ0RFLFFBQVEsRUFBRTtJQUNSTCxJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESSxNQUFNLEVBQUU7SUFDTk4sSUFBSSxFQUFFQztFQUNSLENBQUM7RUFDRE0sYUFBYSxFQUFFO0lBQ2JQLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsSUFBSTtJQUNkQyxNQUFNLEVBQUU7RUFDVixDQUFDO0VBQ0RLLElBQUksRUFBRTtJQUNKUixJQUFJLEVBQUVDLE1BQU07SUFDWlEsSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQztJQUN4QkMsT0FBTyxFQUFFO0VBQ1g7QUFDRixDQUFDLENBQUM7QUFFRkMsTUFBTSxDQUFDQyxPQUFPLEdBQUdqQixRQUFRLENBQUNrQixLQUFLLENBQUMsTUFBTSxFQUFFaEIsVUFBVSxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["mongoose","require","UserSchema","Schema","username","type","String","required","unique","email","password","avatar","solanaAddress","role","enum","default","module","exports","model"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\models\\","sources":["User.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst UserSchema = new mongoose.Schema({\r\n  username: {\r\n    type: String,\r\n    required: true,\r\n    unique: true,\r\n  },\r\n  email: {\r\n    type: String,\r\n    required: true,\r\n    unique: true,\r\n  },\r\n  password: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  avatar: {\r\n    type: String,\r\n  },\r\n  solanaAddress: {\r\n    type: String,\r\n    required: true,\r\n    unique: true,\r\n  },\r\n  role: {\r\n    type: String,\r\n    enum: ['staff', 'admin'],\r\n    default: 'staff',\r\n  },\r\n});\r\n\r\nmodule.exports = mongoose.model('User', UserSchema);\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EACrCC,QAAQ,EAAE;IACRC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE;EACV,CAAC;EACDC,KAAK,EAAE;IACLJ,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE;EACV,CAAC;EACDE,QAAQ,EAAE;IACRL,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDI,MAAM,EAAE;IACNN,IAAI,EAAEC;EACR,CAAC;EACDM,aAAa,EAAE;IACbP,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,IAAI;IACdC,MAAM,EAAE;EACV,CAAC;EACDK,IAAI,EAAE;IACJR,IAAI,EAAEC,MAAM;IACZQ,IAAI,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;IACxBC,OAAO,EAAE;EACX;AACF,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGjB,QAAQ,CAACkB,KAAK,CAAC,MAAM,EAAEhB,UAAU,CAAC","ignoreList":[]}},"mtime":1710131514355},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\authController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const User = require('../models/User');\nconst CryptoJs = require('crypto-js');\nconst jwt = require('jsonwebtoken');\nmodule.exports = {\n  createUser: async (req, res) => {\n    try {\n      const {\n        username,\n        email,\n        password,\n        avatar,\n        solanaAddress,\n        role\n      } = req.body;\n\n      // Mã hóa mật khẩu\n      const encryptedPassword = CryptoJs.AES.encrypt(password, process.env.SECRET).toString();\n      const newUser = new User({\n        username,\n        email,\n        password: encryptedPassword,\n        avatar,\n        solanaAddress,\n        role\n      });\n      const savedUser = await newUser.save();\n      res.json({\n        savedUser: {\n          ...savedUser._doc,\n          password: undefined\n        }\n      });\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  loginUser: async (req, res) => {\n    try {\n      if (req.method === \"GET\") {\n        return res.render('login');\n      }\n      const {\n        email,\n        password\n      } = req.body;\n      const user = await User.findOne({\n        email\n      });\n      if (!user) {\n        return res.status(401).json({\n          error: 'User not found'\n        });\n      }\n\n      // Kiểm tra mật khẩu\n      const bytes = CryptoJs.AES.decrypt(user.password, process.env.SECRET);\n      const originalPassword = bytes.toString(CryptoJs.enc.Utf8);\n      if (originalPassword !== password) {\n        return res.status(401).json({\n          error: 'Invalid credentials'\n        });\n      }\n      const token = jwt.sign({\n        userId: user._id,\n        role: user.role\n      }, process.env.JWT_SEC, {\n        expiresIn: '1h'\n      });\n\n      // Lưu thông tin người dùng và token vào session\n      req.session.user = user;\n      req.session.token = token;\n      console.log(\"Data user: \", user);\n      res.render('menu', {\n        user: user\n      });\n    } catch (error) {\n      console.error(error);\n      res.status(500).json({\n        error: 'Internal Server Error'\n      });\n    }\n  }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsIkNyeXB0b0pzIiwiand0IiwibW9kdWxlIiwiZXhwb3J0cyIsImNyZWF0ZVVzZXIiLCJyZXEiLCJyZXMiLCJ1c2VybmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJhdmF0YXIiLCJzb2xhbmFBZGRyZXNzIiwicm9sZSIsImJvZHkiLCJlbmNyeXB0ZWRQYXNzd29yZCIsIkFFUyIsImVuY3J5cHQiLCJwcm9jZXNzIiwiZW52IiwiU0VDUkVUIiwidG9TdHJpbmciLCJuZXdVc2VyIiwic2F2ZWRVc2VyIiwic2F2ZSIsImpzb24iLCJfZG9jIiwidW5kZWZpbmVkIiwiZXJyb3IiLCJzdGF0dXMiLCJtZXNzYWdlIiwibG9naW5Vc2VyIiwibWV0aG9kIiwicmVuZGVyIiwidXNlciIsImZpbmRPbmUiLCJieXRlcyIsImRlY3J5cHQiLCJvcmlnaW5hbFBhc3N3b3JkIiwiZW5jIiwiVXRmOCIsInRva2VuIiwic2lnbiIsInVzZXJJZCIsIl9pZCIsIkpXVF9TRUMiLCJleHBpcmVzSW4iLCJzZXNzaW9uIiwiY29uc29sZSIsImxvZyJdLCJzb3VyY2VSb290IjoiRzpcXFRUVE5fU1AyNF9TRVJWRVJcXGNvbnRyb2xsZXJzXFwiLCJzb3VyY2VzIjpbImF1dGhDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbHMvVXNlcicpO1xyXG5jb25zdCBDcnlwdG9KcyA9IHJlcXVpcmUoJ2NyeXB0by1qcycpO1xyXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIGNyZWF0ZVVzZXI6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyB1c2VybmFtZSwgZW1haWwsIHBhc3N3b3JkLCBhdmF0YXIsIHNvbGFuYUFkZHJlc3MsIHJvbGUgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgICAgLy8gTcOjIGjDs2EgbeG6rXQga2jhuql1XHJcbiAgICAgIGNvbnN0IGVuY3J5cHRlZFBhc3N3b3JkID0gQ3J5cHRvSnMuQUVTLmVuY3J5cHQocGFzc3dvcmQsIHByb2Nlc3MuZW52LlNFQ1JFVCkudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgIGNvbnN0IG5ld1VzZXIgPSBuZXcgVXNlcih7XHJcbiAgICAgICAgdXNlcm5hbWUsXHJcbiAgICAgICAgZW1haWwsXHJcbiAgICAgICAgcGFzc3dvcmQ6IGVuY3J5cHRlZFBhc3N3b3JkLFxyXG4gICAgICAgIGF2YXRhcixcclxuICAgICAgICBzb2xhbmFBZGRyZXNzLFxyXG4gICAgICAgIHJvbGUsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3Qgc2F2ZWRVc2VyID0gYXdhaXQgbmV3VXNlci5zYXZlKCk7XHJcbiAgICAgIHJlcy5qc29uKHsgc2F2ZWRVc2VyOiB7IC4uLnNhdmVkVXNlci5fZG9jLCBwYXNzd29yZDogdW5kZWZpbmVkIH0gfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGxvZ2luVXNlcjogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGlmIChyZXEubWV0aG9kID09PSBcIkdFVFwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMucmVuZGVyKCdsb2dpbicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSk7XHJcblxyXG4gICAgICAgIGlmICghdXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEtp4buDbSB0cmEgbeG6rXQga2jhuql1XHJcbiAgICAgICAgY29uc3QgYnl0ZXMgPSBDcnlwdG9Kcy5BRVMuZGVjcnlwdCh1c2VyLnBhc3N3b3JkLCBwcm9jZXNzLmVudi5TRUNSRVQpO1xyXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUGFzc3dvcmQgPSBieXRlcy50b1N0cmluZyhDcnlwdG9Kcy5lbmMuVXRmOCk7XHJcblxyXG4gICAgICAgIGlmIChvcmlnaW5hbFBhc3N3b3JkICE9PSBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgY3JlZGVudGlhbHMnIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IHVzZXJJZDogdXNlci5faWQsIHJvbGU6IHVzZXIucm9sZSB9LCBwcm9jZXNzLmVudi5KV1RfU0VDLCB7IGV4cGlyZXNJbjogJzFoJyB9KTtcclxuXHJcbiAgICAgICAgLy8gTMawdSB0aMO0bmcgdGluIG5nxrDhu51pIGTDuW5nIHbDoCB0b2tlbiB2w6BvIHNlc3Npb25cclxuICAgICAgICByZXEuc2Vzc2lvbi51c2VyID0gdXNlcjtcclxuICAgICAgICByZXEuc2Vzc2lvbi50b2tlbiA9IHRva2VuO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgdXNlcjogXCIsIHVzZXIpXHJcblxyXG4gICAgICAgIHJlcy5yZW5kZXIoJ21lbnUnLCB7IHVzZXI6IHVzZXJ9KTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG59O1xyXG4iXSwibWFwcGluZ3Mi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","map":{"version":3,"names":["User","require","CryptoJs","jwt","module","exports","createUser","req","res","username","email","password","avatar","solanaAddress","role","body","encryptedPassword","AES","encrypt","process","env","SECRET","toString","newUser","savedUser","save","json","_doc","undefined","error","status","message","loginUser","method","render","user","findOne","bytes","decrypt","originalPassword","enc","Utf8","token","sign","userId","_id","JWT_SEC","expiresIn","session","console","log"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\controllers\\","sources":["authController.js"],"sourcesContent":["const User = require('../models/User');\r\nconst CryptoJs = require('crypto-js');\r\nconst jwt = require('jsonwebtoken');\r\n\r\nmodule.exports = {\r\n  createUser: async (req, res) => {\r\n    try {\r\n      const { username, email, password, avatar, solanaAddress, role } = req.body;\r\n\r\n      // Mã hóa mật khẩu\r\n      const encryptedPassword = CryptoJs.AES.encrypt(password, process.env.SECRET).toString();\r\n\r\n      const newUser = new User({\r\n        username,\r\n        email,\r\n        password: encryptedPassword,\r\n        avatar,\r\n        solanaAddress,\r\n        role,\r\n      });\r\n\r\n      const savedUser = await newUser.save();\r\n      res.json({ savedUser: { ...savedUser._doc, password: undefined } });\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  },\r\n\r\n  loginUser: async (req, res) => {\r\n    try {\r\n        if (req.method === \"GET\") {\r\n            return res.render('login');\r\n        }\r\n\r\n        const { email, password } = req.body;\r\n\r\n        const user = await User.findOne({ email });\r\n\r\n        if (!user) {\r\n            return res.status(401).json({ error: 'User not found' });\r\n        }\r\n\r\n        // Kiểm tra mật khẩu\r\n        const bytes = CryptoJs.AES.decrypt(user.password, process.env.SECRET);\r\n        const originalPassword = bytes.toString(CryptoJs.enc.Utf8);\r\n\r\n        if (originalPassword !== password) {\r\n            return res.status(401).json({ error: 'Invalid credentials' });\r\n        }\r\n\r\n        const token = jwt.sign({ userId: user._id, role: user.role }, process.env.JWT_SEC, { expiresIn: '1h' });\r\n\r\n        // Lưu thông tin người dùng và token vào session\r\n        req.session.user = user;\r\n        req.session.token = token;\r\n\r\n        console.log(\"Data user: \", user)\r\n\r\n        res.render('menu', { user: user});\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        res.status(500).json({ error: 'Internal Server Error' });\r\n    }\r\n}\r\n\r\n};\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1710130559190},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\category.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst categoryController = require('../controllers/categoryController');\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\n\n// Middleware để kiểm tra session\nrouter.use(sessionMiddleware);\nrouter.get('/update/:id', categoryController.getUpdateCategoryForm);\nrouter.put('/update/:id', categoryController.updateCategory);\nrouter.get('/create', categoryController.getCreateCategoryForm);\nrouter.post('/create', categoryController.createCategory);\nrouter.get('/', categoryController.getAllCategories);\nrouter.get('/:id', categoryController.getCategoryById);\nrouter.delete('/delete/:id', categoryController.deleteCategory);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImNhdGVnb3J5Q29udHJvbGxlciIsInNlc3Npb25NaWRkbGV3YXJlIiwidXNlIiwiZ2V0IiwiZ2V0VXBkYXRlQ2F0ZWdvcnlGb3JtIiwicHV0IiwidXBkYXRlQ2F0ZWdvcnkiLCJnZXRDcmVhdGVDYXRlZ29yeUZvcm0iLCJwb3N0IiwiY3JlYXRlQ2F0ZWdvcnkiLCJnZXRBbGxDYXRlZ29yaWVzIiwiZ2V0Q2F0ZWdvcnlCeUlkIiwiZGVsZXRlIiwiZGVsZXRlQ2F0ZWdvcnkiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJHOlxcVFRUTl9TUDI0X1NFUlZFUlxccm91dGVzXFwiLCJzb3VyY2VzIjpbImNhdGVnb3J5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbmNvbnN0IGNhdGVnb3J5Q29udHJvbGxlciA9IHJlcXVpcmUoJy4uL2NvbnRyb2xsZXJzL2NhdGVnb3J5Q29udHJvbGxlcicpO1xyXG5jb25zdCBzZXNzaW9uTWlkZGxld2FyZSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvc2Vzc2lvbk1pZGRsZXdhcmUnKTtcclxuXHJcbi8vIE1pZGRsZXdhcmUgxJHhu4Mga2nhu4NtIHRyYSBzZXNzaW9uXHJcbnJvdXRlci51c2Uoc2Vzc2lvbk1pZGRsZXdhcmUpO1xyXG5cclxuXHJcbnJvdXRlci5nZXQoJy91cGRhdGUvOmlkJywgY2F0ZWdvcnlDb250cm9sbGVyLmdldFVwZGF0ZUNhdGVnb3J5Rm9ybSk7XHJcbnJvdXRlci5wdXQoJy91cGRhdGUvOmlkJywgY2F0ZWdvcnlDb250cm9sbGVyLnVwZGF0ZUNhdGVnb3J5KTtcclxuXHJcbnJvdXRlci5nZXQoJy9jcmVhdGUnLCBjYXRlZ29yeUNvbnRyb2xsZXIuZ2V0Q3JlYXRlQ2F0ZWdvcnlGb3JtKTtcclxucm91dGVyLnBvc3QoJy9jcmVhdGUnLCBjYXRlZ29yeUNvbnRyb2xsZXIuY3JlYXRlQ2F0ZWdvcnkpO1xyXG5cclxucm91dGVyLmdldCgnLycsIGNhdGVnb3J5Q29udHJvbGxlci5nZXRBbGxDYXRlZ29yaWVzKTtcclxucm91dGVyLmdldCgnLzppZCcsIGNhdGVnb3J5Q29udHJvbGxlci5nZXRDYXRlZ29yeUJ5SWQpO1xyXG5cclxuXHJcbnJvdXRlci5kZWxldGUoJy9kZWxldGUvOmlkJywgY2F0ZWdvcnlDb250cm9sbGVyLmRlbGV0ZUNhdGVnb3J5KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsa0JBQWtCLEdBQUdILE9BQU8sQ0FBQyxtQ0FBbUMsQ0FBQztBQUN2RSxNQUFNSSxpQkFBaUIsR0FBR0osT0FBTyxDQUFDLGlDQUFpQyxDQUFDOztBQUVwRTtBQUNBQyxNQUFNLENBQUNJLEdBQUcsQ0FBQ0QsaUJBQWlCLENBQUM7QUFHN0JILE1BQU0sQ0FBQ0ssR0FBRyxDQUFDLGFBQWEsRUFBRUgsa0JBQWtCLENBQUNJLHFCQUFxQixDQUFDO0FBQ25FTixNQUFNLENBQUNPLEdBQUcsQ0FBQyxhQUFhLEVBQUVMLGtCQUFrQixDQUFDTSxjQUFjLENBQUM7QUFFNURSLE1BQU0sQ0FBQ0ssR0FBRyxDQUFDLFNBQVMsRUFBRUgsa0JBQWtCLENBQUNPLHFCQUFxQixDQUFDO0FBQy9EVCxNQUFNLENBQUNVLElBQUksQ0FBQyxTQUFTLEVBQUVSLGtCQUFrQixDQUFDUyxjQUFjLENBQUM7QUFFekRYLE1BQU0sQ0FBQ0ssR0FBRyxDQUFDLEdBQUcsRUFBRUgsa0JBQWtCLENBQUNVLGdCQUFnQixDQUFDO0FBQ3BEWixNQUFNLENBQUNLLEdBQUcsQ0FBQyxNQUFNLEVBQUVILGtCQUFrQixDQUFDVyxlQUFlLENBQUM7QUFHdERiLE1BQU0sQ0FBQ2MsTUFBTSxDQUFDLGFBQWEsRUFBRVosa0JBQWtCLENBQUNhLGNBQWMsQ0FBQztBQUUvREMsTUFBTSxDQUFDQyxPQUFPLEdBQUdqQixNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","require","router","Router","categoryController","sessionMiddleware","use","get","getUpdateCategoryForm","put","updateCategory","getCreateCategoryForm","post","createCategory","getAllCategories","getCategoryById","delete","deleteCategory","module","exports"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\routes\\","sources":["category.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst categoryController = require('../controllers/categoryController');\r\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\r\n\r\n// Middleware để kiểm tra session\r\nrouter.use(sessionMiddleware);\r\n\r\n\r\nrouter.get('/update/:id', categoryController.getUpdateCategoryForm);\r\nrouter.put('/update/:id', categoryController.updateCategory);\r\n\r\nrouter.get('/create', categoryController.getCreateCategoryForm);\r\nrouter.post('/create', categoryController.createCategory);\r\n\r\nrouter.get('/', categoryController.getAllCategories);\r\nrouter.get('/:id', categoryController.getCategoryById);\r\n\r\n\r\nrouter.delete('/delete/:id', categoryController.deleteCategory);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,kBAAkB,GAAGH,OAAO,CAAC,mCAAmC,CAAC;AACvE,MAAMI,iBAAiB,GAAGJ,OAAO,CAAC,iCAAiC,CAAC;;AAEpE;AACAC,MAAM,CAACI,GAAG,CAACD,iBAAiB,CAAC;AAG7BH,MAAM,CAACK,GAAG,CAAC,aAAa,EAAEH,kBAAkB,CAACI,qBAAqB,CAAC;AACnEN,MAAM,CAACO,GAAG,CAAC,aAAa,EAAEL,kBAAkB,CAACM,cAAc,CAAC;AAE5DR,MAAM,CAACK,GAAG,CAAC,SAAS,EAAEH,kBAAkB,CAACO,qBAAqB,CAAC;AAC/DT,MAAM,CAACU,IAAI,CAAC,SAAS,EAAER,kBAAkB,CAACS,cAAc,CAAC;AAEzDX,MAAM,CAACK,GAAG,CAAC,GAAG,EAAEH,kBAAkB,CAACU,gBAAgB,CAAC;AACpDZ,MAAM,CAACK,GAAG,CAAC,MAAM,EAAEH,kBAAkB,CAACW,eAAe,CAAC;AAGtDb,MAAM,CAACc,MAAM,CAAC,aAAa,EAAEZ,kBAAkB,CAACa,cAAc,CAAC;AAE/DC,MAAM,CAACC,OAAO,GAAGjB,MAAM","ignoreList":[]}},"mtime":1710051807639},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\categoryController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const Category = require('../models/Category');\nmodule.exports = {\n  getCreateCategoryForm: (req, res) => {\n    const user = req.session.user;\n    console.log(\"User:\", user);\n    res.render('category/createCategory', {\n      user\n    });\n  },\n  createCategory: async (req, res) => {\n    try {\n      const {\n        name\n      } = req.body;\n      const newCategory = new Category({\n        name\n      });\n      const savedCategory = await newCategory.save();\n      res.json(savedCategory);\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  getUpdateCategoryForm: async (req, res) => {\n    try {\n      const user = req.session.user;\n      const {\n        id\n      } = req.params;\n      const category = await Category.findById(id);\n      if (!category) {\n        return res.status(404).json({\n          error: 'Category not found'\n        });\n      }\n      res.render('category/updateCategory', {\n        category,\n        user\n      });\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  updateCategory: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      // console.log(\"Category ID:\", id);\n      const {\n        name\n      } = req.body;\n      // console.log(\"name:\", name); \n      const updatedCategory = await Category.findByIdAndUpdate(id, {\n        name\n      }, {\n        new: true\n      });\n      // console.log(\"Updated category:\", updatedCategory);\n      res.json(updatedCategory);\n    } catch (error) {\n      console.error('Error updating category:', error);\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  deleteCategory: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      await Category.findByIdAndDelete(id);\n      res.json({\n        message: 'Category deleted successfully'\n      });\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  getCategoryById: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const category = await Category.findById(id);\n      if (!category) {\n        return res.status(404).json({\n          error: 'Category not found'\n        });\n      }\n      res.json(category);\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  getAllCategories: async (req, res) => {\n    try {\n      const categories = await Category.find();\n      const user = req.session.user;\n      res.render('category/getAllCategory', {\n        categories,\n        user\n      });\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDYXRlZ29yeSIsInJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZ2V0Q3JlYXRlQ2F0ZWdvcnlGb3JtIiwicmVxIiwicmVzIiwidXNlciIsInNlc3Npb24iLCJjb25zb2xlIiwibG9nIiwicmVuZGVyIiwiY3JlYXRlQ2F0ZWdvcnkiLCJuYW1lIiwiYm9keSIsIm5ld0NhdGVnb3J5Iiwic2F2ZWRDYXRlZ29yeSIsInNhdmUiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJtZXNzYWdlIiwiZ2V0VXBkYXRlQ2F0ZWdvcnlGb3JtIiwiaWQiLCJwYXJhbXMiLCJjYXRlZ29yeSIsImZpbmRCeUlkIiwidXBkYXRlQ2F0ZWdvcnkiLCJ1cGRhdGVkQ2F0ZWdvcnkiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsImRlbGV0ZUNhdGVnb3J5IiwiZmluZEJ5SWRBbmREZWxldGUiLCJnZXRDYXRlZ29yeUJ5SWQiLCJnZXRBbGxDYXRlZ29yaWVzIiwiY2F0ZWdvcmllcyIsImZpbmQiXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxjb250cm9sbGVyc1xcIiwic291cmNlcyI6WyJjYXRlZ29yeUNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQ2F0ZWdvcnkgPSByZXF1aXJlKCcuLi9tb2RlbHMvQ2F0ZWdvcnknKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gIGdldENyZWF0ZUNhdGVnb3J5Rm9ybTogKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgIGNvbnNvbGUubG9nKFwiVXNlcjpcIiwgdXNlcik7XHJcbiAgICByZXMucmVuZGVyKCdjYXRlZ29yeS9jcmVhdGVDYXRlZ29yeScsIHsgdXNlciB9KTtcclxuICB9LFxyXG5cclxuICBjcmVhdGVDYXRlZ29yeTogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IG5hbWUgfSA9IHJlcS5ib2R5O1xyXG4gICAgICBjb25zdCBuZXdDYXRlZ29yeSA9IG5ldyBDYXRlZ29yeSh7IG5hbWUgfSk7XHJcbiAgICAgIGNvbnN0IHNhdmVkQ2F0ZWdvcnkgPSBhd2FpdCBuZXdDYXRlZ29yeS5zYXZlKCk7XHJcbiAgICAgIHJlcy5qc29uKHNhdmVkQ2F0ZWdvcnkpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRVcGRhdGVDYXRlZ29yeUZvcm06IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICAgIGNvbnN0IGNhdGVnb3J5ID0gYXdhaXQgQ2F0ZWdvcnkuZmluZEJ5SWQoaWQpO1xyXG4gICAgICBpZiAoIWNhdGVnb3J5KSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdDYXRlZ29yeSBub3QgZm91bmQnIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJlcy5yZW5kZXIoJ2NhdGVnb3J5L3VwZGF0ZUNhdGVnb3J5JywgeyBjYXRlZ29yeSwgdXNlciB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlQ2F0ZWdvcnk6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgICAgLy8gY29uc29sZS5sb2coXCJDYXRlZ29yeSBJRDpcIiwgaWQpO1xyXG4gICAgICBjb25zdCB7IG5hbWUgfSA9IHJlcS5ib2R5O1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhcIm5hbWU6XCIsIG5hbWUpOyBcclxuICAgICAgY29uc3QgdXBkYXRlZENhdGVnb3J5ID0gYXdhaXQgQ2F0ZWdvcnkuZmluZEJ5SWRBbmRVcGRhdGUoaWQsIHsgbmFtZSB9LCB7IG5ldzogdHJ1ZSB9KTtcclxuICAgICAgLy8gY29uc29sZS5sb2coXCJVcGRhdGVkIGNhdGVnb3J5OlwiLCB1cGRhdGVkQ2F0ZWdvcnkpO1xyXG4gICAgICByZXMuanNvbih1cGRhdGVkQ2F0ZWdvcnkpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgY2F0ZWdvcnk6JywgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgXHJcbiAgXHJcblxyXG4gIGRlbGV0ZUNhdGVnb3J5OiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICAgIGF3YWl0IENhdGVnb3J5LmZpbmRCeUlkQW5kRGVsZXRlKGlkKTtcclxuICAgICAgcmVzLmpzb24oeyBtZXNzYWdlOiAnQ2F0ZWdvcnkgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRDYXRlZ29yeUJ5SWQ6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBDYXRlZ29yeS5maW5kQnlJZChpZCk7XHJcbiAgICAgIGlmICghY2F0ZWdvcnkpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0NhdGVnb3J5IG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgIH1cclxuICAgICAgcmVzLmpzb24oY2F0ZWdvcnkpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBnZXRBbGxDYXRlZ29yaWVzOiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBDYXRlZ29yeS5maW5kKCk7XHJcbiAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICByZXMucmVuZGVyKCdjYXRlZ29yeS9nZXRBbGxDYXRlZ29yeScsIHsgY2F0ZWdvcmllcywgdXNlciB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBRTlDQyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUNmQyxxQkFBcUIsRUFBRUEsQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbkMsTUFBTUMsSUFBSSxHQUFHRixHQUFHLENBQUNHLE9BQU8sQ0FBQ0QsSUFBSTtJQUM3QkUsT0FBTyxDQUFDQyxHQUFHLENBQUMsT0FBTyxFQUFFSCxJQUFJLENBQUM7SUFDMUJELEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLHlCQUF5QixFQUFFO01BQUVKO0lBQUssQ0FBQyxDQUFDO0VBQ2pELENBQUM7RUFFREssY0FBYyxFQUFFLE1BQUFBLENBQU9QLEdBQUcsRUFBRUMsR0FBRyxL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","map":{"version":3,"names":["Category","require","module","exports","getCreateCategoryForm","req","res","user","session","console","log","render","createCategory","name","body","newCategory","savedCategory","save","json","error","status","message","getUpdateCategoryForm","id","params","category","findById","updateCategory","updatedCategory","findByIdAndUpdate","new","deleteCategory","findByIdAndDelete","getCategoryById","getAllCategories","categories","find"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\controllers\\","sources":["categoryController.js"],"sourcesContent":["const Category = require('../models/Category');\r\n\r\nmodule.exports = {\r\n  getCreateCategoryForm: (req, res) => {\r\n    const user = req.session.user;\r\n    console.log(\"User:\", user);\r\n    res.render('category/createCategory', { user });\r\n  },\r\n\r\n  createCategory: async (req, res) => {\r\n    try {\r\n      const { name } = req.body;\r\n      const newCategory = new Category({ name });\r\n      const savedCategory = await newCategory.save();\r\n      res.json(savedCategory);\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  },\r\n\r\n  getUpdateCategoryForm: async (req, res) => {\r\n    try {\r\n      const user = req.session.user;\r\n      const { id } = req.params;\r\n      const category = await Category.findById(id);\r\n      if (!category) {\r\n        return res.status(404).json({ error: 'Category not found' });\r\n      }\r\n      res.render('category/updateCategory', { category, user });\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  },\r\n\r\n  updateCategory: async (req, res) => {\r\n    try {\r\n      const { id } = req.params;\r\n      // console.log(\"Category ID:\", id);\r\n      const { name } = req.body;\r\n      // console.log(\"name:\", name); \r\n      const updatedCategory = await Category.findByIdAndUpdate(id, { name }, { new: true });\r\n      // console.log(\"Updated category:\", updatedCategory);\r\n      res.json(updatedCategory);\r\n    } catch (error) {\r\n      console.error('Error updating category:', error);\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  },\r\n  \r\n  \r\n\r\n  deleteCategory: async (req, res) => {\r\n    try {\r\n      const { id } = req.params;\r\n      await Category.findByIdAndDelete(id);\r\n      res.json({ message: 'Category deleted successfully' });\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  },\r\n\r\n  getCategoryById: async (req, res) => {\r\n    try {\r\n      const { id } = req.params;\r\n      const category = await Category.findById(id);\r\n      if (!category) {\r\n        return res.status(404).json({ error: 'Category not found' });\r\n      }\r\n      res.json(category);\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  },\r\n\r\n  getAllCategories: async (req, res) => {\r\n    try {\r\n      const categories = await Category.find();\r\n      const user = req.session.user;\r\n      res.render('category/getAllCategory', { categories, user });\r\n    } catch (error) {\r\n      res.status(500).json({ error: error.message });\r\n    }\r\n  }\r\n};\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAE9CC,MAAM,CAACC,OAAO,GAAG;EACfC,qBAAqB,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;IACnC,MAAMC,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;IAC7BE,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEH,IAAI,CAAC;IAC1BD,GAAG,CAACK,MAAM,CAAC,yBAAyB,EAAE;MAAEJ;IAAK,CAAC,CAAC;EACjD,CAAC;EAEDK,cAAc,EAAE,MAAAA,CAAOP,GAAG,EAAEC,GAAG,KAAK;IAClC,IAAI;MACF,MAAM;QAAEO;MAAK,CAAC,GAAGR,GAAG,CAACS,IAAI;MACzB,MAAMC,WAAW,GAAG,IAAIf,QAAQ,CAAC;QAAEa;MAAK,CAAC,CAAC;MAC1C,MAAMG,aAAa,GAAG,MAAMD,WAAW,CAACE,IAAI,CAAC,CAAC;MAC9CX,GAAG,CAACY,IAAI,CAACF,aAAa,CAAC;IACzB,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;QAAEC,KAAK,EAAEA,KAAK,CAACE;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC;EAEDC,qBAAqB,EAAE,MAAAA,CAAOjB,GAAG,EAAEC,GAAG,KAAK;IACzC,IAAI;MACF,MAAMC,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;MAC7B,MAAM;QAAEgB;MAAG,CAAC,GAAGlB,GAAG,CAACmB,MAAM;MACzB,MAAMC,QAAQ,GAAG,MAAMzB,QAAQ,CAAC0B,QAAQ,CAACH,EAAE,CAAC;MAC5C,IAAI,CAACE,QAAQ,EAAE;QACb,OAAOnB,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;UAAEC,KAAK,EAAE;QAAqB,CAAC,CAAC;MAC9D;MACAb,GAAG,CAACK,MAAM,CAAC,yBAAyB,EAAE;QAAEc,QAAQ;QAAElB;MAAK,CAAC,CAAC;IAC3D,CAAC,CAAC,OAAOY,KAAK,EAAE;MACdb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;QAAEC,KAAK,EAAEA,KAAK,CAACE;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC;EAEDM,cAAc,EAAE,MAAAA,CAAOtB,GAAG,EAAEC,GAAG,KAAK;IAClC,IAAI;MACF,MAAM;QAAEiB;MAAG,CAAC,GAAGlB,GAAG,CAACmB,MAAM;MACzB;MACA,MAAM;QAAEX;MAAK,CAAC,GAAGR,GAAG,CAACS,IAAI;MACzB;MACA,MAAMc,eAAe,GAAG,MAAM5B,QAAQ,CAAC6B,iBAAiB,CAACN,EAAE,EAAE;QAAEV;MAAK,CAAC,EAAE;QAAEiB,GAAG,EAAE;MAAK,CAAC,CAAC;MACrF;MACAxB,GAAG,CAACY,IAAI,CAACU,eAAe,CAAC;IAC3B,CAAC,CAAC,OAAOT,KAAK,EAAE;MACdV,OAAO,CAACU,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChDb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;QAAEC,KAAK,EAAEA,KAAK,CAACE;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC;EAIDU,cAAc,EAAE,MAAAA,CAAO1B,GAAG,EAAEC,GAAG,KAAK;IAClC,IAAI;MACF,MAAM;QAAEiB;MAAG,CAAC,GAAGlB,GAAG,CAACmB,MAAM;MACzB,MAAMxB,QAAQ,CAACgC,iBAAiB,CAACT,EAAE,CAAC;MACpCjB,GAAG,CAACY,IAAI,CAAC;QAAEG,OAAO,EAAE;MAAgC,CAAC,CAAC;IACxD,CAAC,CAAC,OAAOF,KAAK,EAAE;MACdb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;QAAEC,KAAK,EAAEA,KAAK,CAACE;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC;EAEDY,eAAe,EAAE,MAAAA,CAAO5B,GAAG,EAAEC,GAAG,KAAK;IACnC,IAAI;MACF,MAAM;QAAEiB;MAAG,CAAC,GAAGlB,GAAG,CAACmB,MAAM;MACzB,MAAMC,QAAQ,GAAG,MAAMzB,QAAQ,CAAC0B,QAAQ,CAACH,EAAE,CAAC;MAC5C,IAAI,CAACE,QAAQ,EAAE;QACb,OAAOnB,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;UAAEC,KAAK,EAAE;QAAqB,CAAC,CAAC;MAC9D;MACAb,GAAG,CAACY,IAAI,CAACO,QAAQ,CAAC;IACpB,CAAC,CAAC,OAAON,KAAK,EAAE;MACdb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;QAAEC,KAAK,EAAEA,KAAK,CAACE;MAAQ,CAAC,CAAC;IAChD;EACF,CAAC;EAEDa,gBAAgB,EAAE,MAAAA,CAAO7B,GAAG,EAAEC,GAAG,KAAK;IACpC,IAAI;MACF,MAAM6B,UAAU,GAAG,MAAMnC,QAAQ,CAACoC,IAAI,CAAC,CAAC;MACxC,MAAM7B,IAAI,GAAGF,GAAG,CAACG,OAAO,CAACD,IAAI;MAC7BD,GAAG,CAACK,MAAM,CAAC,yBAAyB,EAAE;QAAEwB,UAAU;QAAE5B;MAAK,CAAC,CAAC;IAC7D,CAAC,CAAC,OAAOY,KAAK,EAAE;MACdb,GAAG,CAACc,MAAM,CAAC,GAAG,CAAC,CAACF,IAAI,CAAC;QAAEC,KAAK,EAAEA,KAAK,CAACE;MAAQ,CAAC,CAAC;IAChD;EACF;AACF,CAAC","ignoreList":[]}},"mtime":1710149427148},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\Category.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const mongoose = require('mongoose');\nconst CategorySchema = new mongoose.Schema({\n  name: {\n    type: String,\n    required: true\n  }\n});\nmodule.exports = mongoose.model('Category', CategorySchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJDYXRlZ29yeVNjaGVtYSIsIlNjaGVtYSIsIm5hbWUiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJtb2R1bGUiLCJleHBvcnRzIiwibW9kZWwiXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxtb2RlbHNcXCIsInNvdXJjZXMiOlsiQ2F0ZWdvcnkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xyXG5cclxuY29uc3QgQ2F0ZWdvcnlTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBuYW1lOiB7XHJcbiAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoJ0NhdGVnb3J5JywgQ2F0ZWdvcnlTY2hlbWEpO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQyxNQUFNQyxjQUFjLEdBQUcsSUFBSUYsUUFBUSxDQUFDRyxNQUFNLENBQUM7RUFDekNDLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFO0VBQ1o7QUFDRixDQUFDLENBQUM7QUFFRkMsTUFBTSxDQUFDQyxPQUFPLEdBQUdULFFBQVEsQ0FBQ1UsS0FBSyxDQUFDLFVBQVUsRUFBRVIsY0FBYyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["mongoose","require","CategorySchema","Schema","name","type","String","required","module","exports","model"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\models\\","sources":["Category.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst CategorySchema = new mongoose.Schema({\r\n  name: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n});\r\n\r\nmodule.exports = mongoose.model('Category', CategorySchema);\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,cAAc,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EACzCC,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE;EACZ;AACF,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGT,QAAQ,CAACU,KAAK,CAAC,UAAU,EAAER,cAAc,CAAC","ignoreList":[]}},"mtime":1709959830951},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\question.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst questionController = require('../controllers/questionController');\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\n\n// Middleware để kiểm tra session\nrouter.use('/update', sessionMiddleware);\nrouter.use('/create', sessionMiddleware);\nrouter.use('/delete', sessionMiddleware);\nrouter.get('/update/:id', questionController.getUpdateQuestionForm);\nrouter.put('/update/:id', questionController.updateQuestion);\nrouter.get('/create', questionController.getCreateQuestionForm);\nrouter.post('/create', questionController.createQuestion);\nrouter.get('/', questionController.getAllQuestions);\nrouter.get('/:id', questionController.getQuestionById);\nrouter.delete('/delete/:id', questionController.deleteQuestion);\nrouter.post('/category/:categoryId', questionController.getQuestionsByCategory);\nrouter.post('/category/:categoryId/json', questionController.getQuestionsByCategoryJSON);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInF1ZXN0aW9uQ29udHJvbGxlciIsInNlc3Npb25NaWRkbGV3YXJlIiwidXNlIiwiZ2V0IiwiZ2V0VXBkYXRlUXVlc3Rpb25Gb3JtIiwicHV0IiwidXBkYXRlUXVlc3Rpb24iLCJnZXRDcmVhdGVRdWVzdGlvbkZvcm0iLCJwb3N0IiwiY3JlYXRlUXVlc3Rpb24iLCJnZXRBbGxRdWVzdGlvbnMiLCJnZXRRdWVzdGlvbkJ5SWQiLCJkZWxldGUiLCJkZWxldGVRdWVzdGlvbiIsImdldFF1ZXN0aW9uc0J5Q2F0ZWdvcnkiLCJnZXRRdWVzdGlvbnNCeUNhdGVnb3J5SlNPTiIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxyb3V0ZXNcXCIsInNvdXJjZXMiOlsicXVlc3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgcXVlc3Rpb25Db250cm9sbGVyID0gcmVxdWlyZSgnLi4vY29udHJvbGxlcnMvcXVlc3Rpb25Db250cm9sbGVyJyk7XHJcbmNvbnN0IHNlc3Npb25NaWRkbGV3YXJlID0gcmVxdWlyZSgnLi4vbWlkZGxld2FyZS9zZXNzaW9uTWlkZGxld2FyZScpO1xyXG5cclxuLy8gTWlkZGxld2FyZSDEkeG7gyBraeG7g20gdHJhIHNlc3Npb25cclxucm91dGVyLnVzZSgnL3VwZGF0ZScsIHNlc3Npb25NaWRkbGV3YXJlKTtcclxucm91dGVyLnVzZSgnL2NyZWF0ZScsIHNlc3Npb25NaWRkbGV3YXJlKTtcclxucm91dGVyLnVzZSgnL2RlbGV0ZScsIHNlc3Npb25NaWRkbGV3YXJlKTtcclxuXHJcbnJvdXRlci5nZXQoJy91cGRhdGUvOmlkJywgcXVlc3Rpb25Db250cm9sbGVyLmdldFVwZGF0ZVF1ZXN0aW9uRm9ybSk7XHJcbnJvdXRlci5wdXQoJy91cGRhdGUvOmlkJywgcXVlc3Rpb25Db250cm9sbGVyLnVwZGF0ZVF1ZXN0aW9uKTtcclxuXHJcbnJvdXRlci5nZXQoJy9jcmVhdGUnLCBxdWVzdGlvbkNvbnRyb2xsZXIuZ2V0Q3JlYXRlUXVlc3Rpb25Gb3JtKTtcclxucm91dGVyLnBvc3QoJy9jcmVhdGUnLCBxdWVzdGlvbkNvbnRyb2xsZXIuY3JlYXRlUXVlc3Rpb24pO1xyXG5cclxucm91dGVyLmdldCgnLycsIHF1ZXN0aW9uQ29udHJvbGxlci5nZXRBbGxRdWVzdGlvbnMpO1xyXG5yb3V0ZXIuZ2V0KCcvOmlkJywgcXVlc3Rpb25Db250cm9sbGVyLmdldFF1ZXN0aW9uQnlJZCk7XHJcblxyXG5yb3V0ZXIuZGVsZXRlKCcvZGVsZXRlLzppZCcsIHF1ZXN0aW9uQ29udHJvbGxlci5kZWxldGVRdWVzdGlvbik7XHJcblxyXG5yb3V0ZXIucG9zdCgnL2NhdGVnb3J5LzpjYXRlZ29yeUlkJywgcXVlc3Rpb25Db250cm9sbGVyLmdldFF1ZXN0aW9uc0J5Q2F0ZWdvcnkpO1xyXG5yb3V0ZXIucG9zdCgnL2NhdGVnb3J5LzpjYXRlZ29yeUlkL2pzb24nLCBxdWVzdGlvbkNvbnRyb2xsZXIuZ2V0UXVlc3Rpb25zQnlDYXRlZ29yeUpTT04pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNQyxrQkFBa0IsR0FBR0gsT0FBTyxDQUFDLG1DQUFtQyxDQUFDO0FBQ3ZFLE1BQU1JLGlCQUFpQixHQUFHSixPQUFPLENBQUMsaUNBQWlDLENBQUM7O0FBRXBFO0FBQ0FDLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDLFNBQVMsRUFBRUQsaUJBQWlCLENBQUM7QUFDeENILE1BQU0sQ0FBQ0ksR0FBRyxDQUFDLFNBQVMsRUFBRUQsaUJBQWlCLENBQUM7QUFDeENILE1BQU0sQ0FBQ0ksR0FBRyxDQUFDLFNBQVMsRUFBRUQsaUJBQWlCLENBQUM7QUFFeENILE1BQU0sQ0FBQ0ssR0FBRyxDQUFDLGFBQWEsRUFBRUgsa0JBQWtCLENBQUNJLHFCQUFxQixDQUFDO0FBQ25FTixNQUFNLENBQUNPLEdBQUcsQ0FBQyxhQUFhLEVBQUVMLGtCQUFrQixDQUFDTSxjQUFjLENBQUM7QUFFNURSLE1BQU0sQ0FBQ0ssR0FBRyxDQUFDLFNBQVMsRUFBRUgsa0JBQWtCLENBQUNPLHFCQUFxQixDQUFDO0FBQy9EVCxNQUFNLENBQUNVLElBQUksQ0FBQyxTQUFTLEVBQUVSLGtCQUFrQixDQUFDUyxjQUFjLENBQUM7QUFFekRYLE1BQU0sQ0FBQ0ssR0FBRyxDQUFDLEdBQUcsRUFBRUgsa0JBQWtCLENBQUNVLGVBQWUsQ0FBQztBQUNuRFosTUFBTSxDQUFDSyxHQUFHLENBQUMsTUFBTSxFQUFFSCxrQkFBa0IsQ0FBQ1csZUFBZSxDQUFDO0FBRXREYixNQUFNLENBQUNjLE1BQU0sQ0FBQyxhQUFhLEVBQUVaLGtCQUFrQixDQUFDYSxjQUFjLENBQUM7QUFFL0RmLE1BQU0sQ0FBQ1UsSUFBSSxDQUFDLHVCQUF1QixFQUFFUixrQkFBa0IsQ0FBQ2Msc0JBQXNCLENBQUM7QUFDL0VoQixNQUFNLENBQUNVLElBQUksQ0FBQyw0QkFBNEIsRUFBRVIsa0JBQWtCLENBQUNlLDBCQUEwQixDQUFDO0FBRXhGQyxNQUFNLENBQUNDLE9BQU8sR0FBR25CLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","questionController","sessionMiddleware","use","get","getUpdateQuestionForm","put","updateQuestion","getCreateQuestionForm","post","createQuestion","getAllQuestions","getQuestionById","delete","deleteQuestion","getQuestionsByCategory","getQuestionsByCategoryJSON","module","exports"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\routes\\","sources":["question.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst questionController = require('../controllers/questionController');\r\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\r\n\r\n// Middleware để kiểm tra session\r\nrouter.use('/update', sessionMiddleware);\r\nrouter.use('/create', sessionMiddleware);\r\nrouter.use('/delete', sessionMiddleware);\r\n\r\nrouter.get('/update/:id', questionController.getUpdateQuestionForm);\r\nrouter.put('/update/:id', questionController.updateQuestion);\r\n\r\nrouter.get('/create', questionController.getCreateQuestionForm);\r\nrouter.post('/create', questionController.createQuestion);\r\n\r\nrouter.get('/', questionController.getAllQuestions);\r\nrouter.get('/:id', questionController.getQuestionById);\r\n\r\nrouter.delete('/delete/:id', questionController.deleteQuestion);\r\n\r\nrouter.post('/category/:categoryId', questionController.getQuestionsByCategory);\r\nrouter.post('/category/:categoryId/json', questionController.getQuestionsByCategoryJSON);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,kBAAkB,GAAGH,OAAO,CAAC,mCAAmC,CAAC;AACvE,MAAMI,iBAAiB,GAAGJ,OAAO,CAAC,iCAAiC,CAAC;;AAEpE;AACAC,MAAM,CAACI,GAAG,CAAC,SAAS,EAAED,iBAAiB,CAAC;AACxCH,MAAM,CAACI,GAAG,CAAC,SAAS,EAAED,iBAAiB,CAAC;AACxCH,MAAM,CAACI,GAAG,CAAC,SAAS,EAAED,iBAAiB,CAAC;AAExCH,MAAM,CAACK,GAAG,CAAC,aAAa,EAAEH,kBAAkB,CAACI,qBAAqB,CAAC;AACnEN,MAAM,CAACO,GAAG,CAAC,aAAa,EAAEL,kBAAkB,CAACM,cAAc,CAAC;AAE5DR,MAAM,CAACK,GAAG,CAAC,SAAS,EAAEH,kBAAkB,CAACO,qBAAqB,CAAC;AAC/DT,MAAM,CAACU,IAAI,CAAC,SAAS,EAAER,kBAAkB,CAACS,cAAc,CAAC;AAEzDX,MAAM,CAACK,GAAG,CAAC,GAAG,EAAEH,kBAAkB,CAACU,eAAe,CAAC;AACnDZ,MAAM,CAACK,GAAG,CAAC,MAAM,EAAEH,kBAAkB,CAACW,eAAe,CAAC;AAEtDb,MAAM,CAACc,MAAM,CAAC,aAAa,EAAEZ,kBAAkB,CAACa,cAAc,CAAC;AAE/Df,MAAM,CAACU,IAAI,CAAC,uBAAuB,EAAER,kBAAkB,CAACc,sBAAsB,CAAC;AAC/EhB,MAAM,CAACU,IAAI,CAAC,4BAA4B,EAAER,kBAAkB,CAACe,0BAA0B,CAAC;AAExFC,MAAM,CAACC,OAAO,GAAGnB,MAAM","ignoreList":[]}},"mtime":1710062632577},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\questionController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const Question = require('../models/question');\nconst Category = require('../models/Category');\nconst paginate = async (model, query, page = 1, limit = 10) => {\n  const skip = (page - 1) * limit;\n  const totalDocuments = await model.countDocuments(query);\n  const totalPages = Math.ceil(totalDocuments / limit);\n  const results = await model.find(query).skip(skip).limit(limit);\n  return {\n    results,\n    totalPages\n  };\n};\nmodule.exports = {\n  getCreateQuestionForm: async (req, res) => {\n    try {\n      const categories = await Category.find();\n      const user = req.session.user;\n      res.render('question/createQuestion', {\n        categories,\n        user\n      });\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  createQuestion: async (req, res) => {\n    try {\n      const {\n        content,\n        category,\n        answers\n      } = req.body;\n      const newQuestion = new Question({\n        content,\n        category,\n        answers\n      });\n      const savedQuestion = await newQuestion.save();\n      res.json(savedQuestion);\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  getUpdateQuestionForm: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const question = await Question.findById(id);\n      const categories = await Category.find();\n      const user = req.session.user;\n      if (!question) {\n        return res.status(404).json({\n          error: 'Question not found'\n        });\n      }\n      res.render('question/updateQuestion', {\n        question,\n        categories,\n        user\n      });\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  updateQuestion: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const {\n        content,\n        category,\n        answers,\n        correctAnswer\n      } = req.body;\n      const updatedQuestion = await Question.findByIdAndUpdate(id, {\n        content,\n        category,\n        answers,\n        correctAnswer\n      }, {\n        new: true\n      });\n      if (!updatedQuestion) {\n        return res.status(404).json({\n          message: 'Question not found'\n        });\n      }\n      res.json(updatedQuestion);\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  deleteQuestion: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      await Question.findByIdAndDelete(id);\n      res.json({\n        message: 'Question deleted successfully'\n      });\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  getQuestionById: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const question = await Question.findById(id);\n      if (!question) {\n        return res.status(404).json({\n          error: 'Question not found'\n        });\n      }\n      res.json(question);\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  getAllQuestions: async (req, res) => {\n    try {\n      const page = parseInt(req.query.page) || 1; // Lấy số trang từ query, mặc định là trang 1\n      const limit = 5; // Số lượng câu hỏi trên mỗi trang\n      const offset = (page - 1) * limit; // Vị trí bắt đầu của trang hiện tại\n      const questions = await Question.find().populate('category').skip(offset).limit(limit);\n      const count = await Question.countDocuments(); // Tổng số câu hỏi\n      const totalPages = Math.ceil(count / limit); // Tính số trang\n      const categories = await Category.find();\n      const user = req.session.user;\n      res.render('question/getAllQuestions', {\n        questions,\n        categories,\n        user,\n        totalPages,\n        currentPage: page,\n        totalQuestions: count\n      });\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  getQuestionsByCategory: async (req, res) => {\n    try {\n      const {\n        categoryId\n      } = req.params;\n      const questions = await Question.find({\n        category: categoryId\n      }).populate('category');\n      const totalQuestions = await Question.countDocuments({\n        category: categoryId\n      });\n      const user = req.session.user;\n      res.render('question/getAllQuestions', {\n        questions,\n        user,\n        totalQuestions\n      });\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  getQuestionsByCategoryJSON: async (req, res) => {\n    try {\n      const {\n        categoryId\n      } = req.params;\n      const questions = await Question.find({\n        category: categoryId\n      }).populate('category');\n      res.json(questions);\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJRdWVzdGlvbiIsInJlcXVpcmUiLCJDYXRlZ29yeSIsInBhZ2luYXRlIiwibW9kZWwiLCJxdWVyeSIsInBhZ2UiLCJsaW1pdCIsInNraXAiLCJ0b3RhbERvY3VtZW50cyIsImNvdW50RG9jdW1lbnRzIiwidG90YWxQYWdlcyIsIk1hdGgiLCJjZWlsIiwicmVzdWx0cyIsImZpbmQiLCJtb2R1bGUiLCJleHBvcnRzIiwiZ2V0Q3JlYXRlUXVlc3Rpb25Gb3JtIiwicmVxIiwicmVzIiwiY2F0ZWdvcmllcyIsInVzZXIiLCJzZXNzaW9uIiwicmVuZGVyIiwiZXJyb3IiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImNyZWF0ZVF1ZXN0aW9uIiwiY29udGVudCIsImNhdGVnb3J5IiwiYW5zd2VycyIsImJvZHkiLCJuZXdRdWVzdGlvbiIsInNhdmVkUXVlc3Rpb24iLCJzYXZlIiwiZ2V0VXBkYXRlUXVlc3Rpb25Gb3JtIiwiaWQiLCJwYXJhbXMiLCJxdWVzdGlvbiIsImZpbmRCeUlkIiwidXBkYXRlUXVlc3Rpb24iLCJjb3JyZWN0QW5zd2VyIiwidXBkYXRlZFF1ZXN0aW9uIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCJuZXciLCJkZWxldGVRdWVzdGlvbiIsImZpbmRCeUlkQW5kRGVsZXRlIiwiZ2V0UXVlc3Rpb25CeUlkIiwiZ2V0QWxsUXVlc3Rpb25zIiwicGFyc2VJbnQiLCJvZmZzZXQiLCJxdWVzdGlvbnMiLCJwb3B1bGF0ZSIsImNvdW50IiwiY3VycmVudFBhZ2UiLCJ0b3RhbFF1ZXN0aW9ucyIsImdldFF1ZXN0aW9uc0J5Q2F0ZWdvcnkiLCJjYXRlZ29yeUlkIiwiZ2V0UXVlc3Rpb25zQnlDYXRlZ29yeUpTT04iXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxjb250cm9sbGVyc1xcIiwic291cmNlcyI6WyJxdWVzdGlvbkNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUXVlc3Rpb24gPSByZXF1aXJlKCcuLi9tb2RlbHMvcXVlc3Rpb24nKTtcclxuY29uc3QgQ2F0ZWdvcnkgPSByZXF1aXJlKCcuLi9tb2RlbHMvQ2F0ZWdvcnknKTtcclxuXHJcbmNvbnN0IHBhZ2luYXRlID0gYXN5bmMgKG1vZGVsLCBxdWVyeSwgcGFnZSA9IDEsIGxpbWl0ID0gMTApID0+IHtcclxuICAgIGNvbnN0IHNraXAgPSAocGFnZSAtIDEpICogbGltaXQ7XHJcbiAgICBjb25zdCB0b3RhbERvY3VtZW50cyA9IGF3YWl0IG1vZGVsLmNvdW50RG9jdW1lbnRzKHF1ZXJ5KTtcclxuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWxEb2N1bWVudHMgLyBsaW1pdCk7XHJcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgbW9kZWwuZmluZChxdWVyeSkuc2tpcChza2lwKS5saW1pdChsaW1pdCk7XHJcbiAgICByZXR1cm4geyByZXN1bHRzLCB0b3RhbFBhZ2VzIH07XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGdldENyZWF0ZVF1ZXN0aW9uRm9ybTogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IENhdGVnb3J5LmZpbmQoKTtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIHJlcy5yZW5kZXIoJ3F1ZXN0aW9uL2NyZWF0ZVF1ZXN0aW9uJywgeyBjYXRlZ29yaWVzLCB1c2VyIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBjcmVhdGVRdWVzdGlvbjogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgeyBjb250ZW50LCBjYXRlZ29yeSwgYW5zd2VycyB9ID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1F1ZXN0aW9uID0gbmV3IFF1ZXN0aW9uKHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIGFuc3dlcnMsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBzYXZlZFF1ZXN0aW9uID0gYXdhaXQgbmV3UXVlc3Rpb24uc2F2ZSgpO1xyXG4gICAgICAgICAgICByZXMuanNvbihzYXZlZFF1ZXN0aW9uKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgZ2V0VXBkYXRlUXVlc3Rpb25Gb3JtOiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbiA9IGF3YWl0IFF1ZXN0aW9uLmZpbmRCeUlkKGlkKTtcclxuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IENhdGVnb3J5LmZpbmQoKTtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIGlmICghcXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUXVlc3Rpb24gbm90IGZvdW5kJyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXMucmVuZGVyKCdxdWVzdGlvbi91cGRhdGVRdWVzdGlvbicsIHsgcXVlc3Rpb24sIGNhdGVnb3JpZXMsIHVzZXIgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVF1ZXN0aW9uOiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgICAgICAgICBjb25zdCB7IGNvbnRlbnQsIGNhdGVnb3J5LCBhbnN3ZXJzLCBjb3JyZWN0QW5zd2VyIH0gPSByZXEuYm9keTtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFF1ZXN0aW9uID0gYXdhaXQgUXVlc3Rpb24uZmluZEJ5SWRBbmRVcGRhdGUoXHJcbiAgICAgICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgICAgIHsgY29udGVudCwgY2F0ZWdvcnksIGFuc3dlcnMsIGNvcnJlY3RBbnN3ZXIgfSxcclxuICAgICAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKCF1cGRhdGVkUXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6ICdRdWVzdGlvbiBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlcy5qc29uKHVwZGF0ZWRRdWVzdGlvbik7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgZGVsZXRlUXVlc3Rpb246IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICAgICAgICAgIGF3YWl0IFF1ZXN0aW9uLmZpbmRCeUlkQW5kRGVsZXRlKGlkKTtcclxuICAgICAgICAgICAgcmVzLmpzb24oeyBtZXNzYWdlOiAnUXVlc3Rpb24gZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFF1ZXN0aW9uQnlJZDogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgICAgICAgICAgY29uc3QgcXVlc3Rpb24gPSBhd2FpdCBRdWVzdGlvbi5maW5kQnlJZChpZCk7XHJcbiAgICAgICAgICAgIGlmICghcXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUXVlc3Rpb24gbm90IGZvdW5kJyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXMuanNvbihxdWVzdGlvbik7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGdldEFsbFF1ZXN0aW9uczogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgcGFnZSA9IHBhcnNlSW50KHJlcS5xdWVyeS5wYWdlKSB8fCAxOyAvLyBM4bqleSBz4buRIHRyYW5nIHThu6sgcXVlcnksIG3hurdjIMSR4buLbmggbMOgIHRyYW5nIDFcclxuICAgICAgICAgICAgY29uc3QgbGltaXQgPSA1OyAvLyBT4buRIGzGsOG7o25nIGPDonUgaOG7j2kgdHLDqm4gbeG7l2kgdHJhbmdcclxuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gKHBhZ2UgLSAxKSAqIGxpbWl0OyAvLyBW4buLIHRyw60gYuG6r3QgxJHhuqd1IGPhu6dhIHRyYW5nIGhp4buHbiB04bqhaVxyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbnMgPSBhd2FpdCBRdWVzdGlvbi5maW5kKCkucG9wdWxhdGUoJ2NhdGVnb3J5Jykuc2tpcChvZmZzZXQpLmxpbWl0KGxpbWl0KTtcclxuICAgICAgICAgICAgY29uc3QgY291bnQgPSBhd2FpdCBRdWVzdGlvbi5jb3VudERvY3VtZW50cygpOyAvLyBU4buVbmcgc+G7kSBjw6J1IGjhu49pXHJcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwoY291bnQgLyBsaW1pdCk7IC8vIFTDrW5oIHPhu5EgdHJhbmdcclxuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IENhdGVnb3J5LmZpbmQoKTtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIHJlcy5yZW5kZXIoJ3F1ZXN0aW9uL2dldEFsbFF1ZXN0aW9ucycsIHsgcXVlc3Rpb25zLCBjYXRlZ29yaWVzLCB1c2VyLCB0b3RhbFBhZ2VzLCBjdXJyZW50UGFnZTogcGFnZSwgdG90YWxRdWVzdGlvbnM6IGNvdW50ICB9KTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgZ2V0UXVlc3Rpb25zQnlDYXRlZ29yeTogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgeyBjYXRlZ29yeUlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbnMgPSBhd2FpdCBRdWVzdGlvbi5maW5kKHsgY2F0ZWdvcnk6IGNhdGVnb3J5SWQgfSkucG9wdWxhdGUoJ2NhdGVnb3J5Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsUXVlc3Rpb25zID0gYXdhaXQgUXVlc3Rpb24uY291bnREb2N1bWVudHMoeyBjYXRlZ29yeTogY2F0ZWdvcnlJZCB9KTsgXHJcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSByZXEuc2Vzc2lvbi51c2VyO1xyXG4gICAgICAgICAgICByZXMucmVuZGVyKCdxdWVzdGlvbi9nZXRBbGxRdWVzdGlvbnMnLCB7IHF1ZXN0aW9ucywgdXNlciwgdG90YWxRdWVzdGlvbnMgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBnZXRRdWVzdGlvbnNCeUNhdGVnb3J5SlNPTjogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgeyBjYXRlZ29yeUlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbnMgPSBhd2FpdCBRdWVzdGlvbi5maW5kKHsgY2F0ZWdvcnk6IGNhdGVnb3J5SWQgfSkucG9wdWxhdGUoJ2NhdGVnb3J5Jyk7XHJcbiAgICAgICAgICAgIHJlcy5qc29uKHF1ZXN0aW9ucyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG59O1xyXG4iXSwi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","map":{"version":3,"names":["Question","require","Category","paginate","model","query","page","limit","skip","totalDocuments","countDocuments","totalPages","Math","ceil","results","find","module","exports","getCreateQuestionForm","req","res","categories","user","session","render","error","status","json","message","createQuestion","content","category","answers","body","newQuestion","savedQuestion","save","getUpdateQuestionForm","id","params","question","findById","updateQuestion","correctAnswer","updatedQuestion","findByIdAndUpdate","new","deleteQuestion","findByIdAndDelete","getQuestionById","getAllQuestions","parseInt","offset","questions","populate","count","currentPage","totalQuestions","getQuestionsByCategory","categoryId","getQuestionsByCategoryJSON"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\controllers\\","sources":["questionController.js"],"sourcesContent":["const Question = require('../models/question');\r\nconst Category = require('../models/Category');\r\n\r\nconst paginate = async (model, query, page = 1, limit = 10) => {\r\n    const skip = (page - 1) * limit;\r\n    const totalDocuments = await model.countDocuments(query);\r\n    const totalPages = Math.ceil(totalDocuments / limit);\r\n    const results = await model.find(query).skip(skip).limit(limit);\r\n    return { results, totalPages };\r\n};\r\n\r\nmodule.exports = {\r\n    getCreateQuestionForm: async (req, res) => {\r\n        try {\r\n            const categories = await Category.find();\r\n            const user = req.session.user;\r\n            res.render('question/createQuestion', { categories, user });\r\n        } catch (error) {\r\n            res.status(500).json({ error: error.message });\r\n        }\r\n    },\r\n\r\n    createQuestion: async (req, res) => {\r\n        try {\r\n            const { content, category, answers } = req.body;\r\n            const newQuestion = new Question({\r\n                content,\r\n                category,\r\n                answers,\r\n            });\r\n            const savedQuestion = await newQuestion.save();\r\n            res.json(savedQuestion);\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n\r\n    getUpdateQuestionForm: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            const question = await Question.findById(id);\r\n            const categories = await Category.find();\r\n            const user = req.session.user;\r\n            if (!question) {\r\n                return res.status(404).json({ error: 'Question not found' });\r\n            }\r\n            res.render('question/updateQuestion', { question, categories, user });\r\n        } catch (error) {\r\n            res.status(500).json({ error: error.message });\r\n        }\r\n    },\r\n\r\n    updateQuestion: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            const { content, category, answers, correctAnswer } = req.body;\r\n            const updatedQuestion = await Question.findByIdAndUpdate(\r\n                id,\r\n                { content, category, answers, correctAnswer },\r\n                { new: true }\r\n            );\r\n            if (!updatedQuestion) {\r\n                return res.status(404).json({ message: 'Question not found' });\r\n            }\r\n            res.json(updatedQuestion);\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n    deleteQuestion: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            await Question.findByIdAndDelete(id);\r\n            res.json({ message: 'Question deleted successfully' });\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n    getQuestionById: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            const question = await Question.findById(id);\r\n            if (!question) {\r\n                return res.status(404).json({ error: 'Question not found' });\r\n            }\r\n            res.json(question);\r\n        } catch (error) {\r\n            res.status(500).json({ error: error.message });\r\n        }\r\n    },\r\n\r\n    getAllQuestions: async (req, res) => {\r\n        try {\r\n            const page = parseInt(req.query.page) || 1; // Lấy số trang từ query, mặc định là trang 1\r\n            const limit = 5; // Số lượng câu hỏi trên mỗi trang\r\n            const offset = (page - 1) * limit; // Vị trí bắt đầu của trang hiện tại\r\n            const questions = await Question.find().populate('category').skip(offset).limit(limit);\r\n            const count = await Question.countDocuments(); // Tổng số câu hỏi\r\n            const totalPages = Math.ceil(count / limit); // Tính số trang\r\n            const categories = await Category.find();\r\n            const user = req.session.user;\r\n            res.render('question/getAllQuestions', { questions, categories, user, totalPages, currentPage: page, totalQuestions: count  });\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n    \r\n    getQuestionsByCategory: async (req, res) => {\r\n        try {\r\n            const { categoryId } = req.params;\r\n            const questions = await Question.find({ category: categoryId }).populate('category');\r\n            const totalQuestions = await Question.countDocuments({ category: categoryId }); \r\n            const user = req.session.user;\r\n            res.render('question/getAllQuestions', { questions, user, totalQuestions });\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n    getQuestionsByCategoryJSON: async (req, res) => {\r\n        try {\r\n            const { categoryId } = req.params;\r\n            const questions = await Question.find({ category: categoryId }).populate('category');\r\n            res.json(questions);\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    }\r\n    \r\n};\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1710139565624},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\question.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const mongoose = require('mongoose');\nconst AnswerSchema = new mongoose.Schema({\n  answer: {\n    type: String,\n    required: true\n  },\n  correct: {\n    type: String,\n    required: true\n  }\n});\nconst QuestionSchema = new mongoose.Schema({\n  content: {\n    type: String,\n    required: true\n  },\n  category: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'Category',\n    required: true\n  },\n  answers: [AnswerSchema]\n});\nmodule.exports = mongoose.model('Question', QuestionSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJBbnN3ZXJTY2hlbWEiLCJTY2hlbWEiLCJhbnN3ZXIiLCJ0eXBlIiwiU3RyaW5nIiwicmVxdWlyZWQiLCJjb3JyZWN0IiwiUXVlc3Rpb25TY2hlbWEiLCJjb250ZW50IiwiY2F0ZWdvcnkiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwiYW5zd2VycyIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiRzpcXFRUVE5fU1AyNF9TRVJWRVJcXG1vZGVsc1xcIiwic291cmNlcyI6WyJxdWVzdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcblxyXG5jb25zdCBBbnN3ZXJTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKHtcclxuICBhbnN3ZXI6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gIH0sXHJcbiAgY29ycmVjdDoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfVxyXG59KTtcclxuXHJcbmNvbnN0IFF1ZXN0aW9uU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XHJcbiAgY29udGVudDoge1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfSxcclxuICBjYXRlZ29yeToge1xyXG4gICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLFxyXG4gICAgcmVmOiAnQ2F0ZWdvcnknLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgfSxcclxuICBhbnN3ZXJzOiBbQW5zd2VyU2NoZW1hXSxcclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKCdRdWVzdGlvbicsIFF1ZXN0aW9uU2NoZW1hKTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFFcEMsTUFBTUMsWUFBWSxHQUFHLElBQUlGLFFBQVEsQ0FBQ0csTUFBTSxDQUFDO0VBQ3ZDQyxNQUFNLEVBQUU7SUFDTkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsT0FBTyxFQUFFO0lBQ1BILElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUU7RUFDWjtBQUNGLENBQUMsQ0FBQztBQUVGLE1BQU1FLGNBQWMsR0FBRyxJQUFJVCxRQUFRLENBQUNHLE1BQU0sQ0FBQztFQUN6Q08sT0FBTyxFQUFFO0lBQ1BMLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RJLFFBQVEsRUFBRTtJQUNSTixJQUFJLEVBQUVMLFFBQVEsQ0FBQ0csTUFBTSxDQUFDUyxLQUFLLENBQUNDLFFBQVE7SUFDcENDLEdBQUcsRUFBRSxVQUFVO0lBQ2ZQLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFEsT0FBTyxFQUFFLENBQUNiLFlBQVk7QUFDeEIsQ0FBQyxDQUFDO0FBRUZjLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHakIsUUFBUSxDQUFDa0IsS0FBSyxDQUFDLFVBQVUsRUFBRVQsY0FBYyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["mongoose","require","AnswerSchema","Schema","answer","type","String","required","correct","QuestionSchema","content","category","Types","ObjectId","ref","answers","module","exports","model"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\models\\","sources":["question.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst AnswerSchema = new mongoose.Schema({\r\n  answer: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  correct: {\r\n    type: String,\r\n    required: true,\r\n  }\r\n});\r\n\r\nconst QuestionSchema = new mongoose.Schema({\r\n  content: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  category: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'Category',\r\n    required: true,\r\n  },\r\n  answers: [AnswerSchema],\r\n});\r\n\r\nmodule.exports = mongoose.model('Question', QuestionSchema);\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,YAAY,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EACvCC,MAAM,EAAE;IACNC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,OAAO,EAAE;IACPH,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE;EACZ;AACF,CAAC,CAAC;AAEF,MAAME,cAAc,GAAG,IAAIT,QAAQ,CAACG,MAAM,CAAC;EACzCO,OAAO,EAAE;IACPL,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDI,QAAQ,EAAE;IACRN,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACS,KAAK,CAACC,QAAQ;IACpCC,GAAG,EAAE,UAAU;IACfP,QAAQ,EAAE;EACZ,CAAC;EACDQ,OAAO,EAAE,CAACb,YAAY;AACxB,CAAC,CAAC;AAEFc,MAAM,CAACC,OAAO,GAAGjB,QAAQ,CAACkB,KAAK,CAAC,UAAU,EAAET,cAAc,CAAC","ignoreList":[]}},"mtime":1710053549419},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst testController = require('../controllers/testController');\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\n\n// Middleware để kiểm tra session\nrouter.use(sessionMiddleware);\nrouter.post('/questions/category/:categoryId', testController.getQuestionsByCategory);\nrouter.get('/create', testController.renderQuestionList);\nrouter.post('/create', testController.createTest);\nrouter.get('/:id', testController.getTestById);\nrouter.get('/', testController.getAllTests);\nrouter.get('/update/:id', testController.renderUpdateTest);\nrouter.put('/update/:id', testController.updateTest);\n\n// router.delete('/:id', testController.deleteTest);\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsInRlc3RDb250cm9sbGVyIiwic2Vzc2lvbk1pZGRsZXdhcmUiLCJ1c2UiLCJwb3N0IiwiZ2V0UXVlc3Rpb25zQnlDYXRlZ29yeSIsImdldCIsInJlbmRlclF1ZXN0aW9uTGlzdCIsImNyZWF0ZVRlc3QiLCJnZXRUZXN0QnlJZCIsImdldEFsbFRlc3RzIiwicmVuZGVyVXBkYXRlVGVzdCIsInB1dCIsInVwZGF0ZVRlc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJHOlxcVFRUTl9TUDI0X1NFUlZFUlxccm91dGVzXFwiLCJzb3VyY2VzIjpbInRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgdGVzdENvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy90ZXN0Q29udHJvbGxlcicpO1xyXG5jb25zdCBzZXNzaW9uTWlkZGxld2FyZSA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmUvc2Vzc2lvbk1pZGRsZXdhcmUnKTtcclxuXHJcbi8vIE1pZGRsZXdhcmUgxJHhu4Mga2nhu4NtIHRyYSBzZXNzaW9uXHJcbnJvdXRlci51c2Uoc2Vzc2lvbk1pZGRsZXdhcmUpO1xyXG5cclxuXHJcbnJvdXRlci5wb3N0KCcvcXVlc3Rpb25zL2NhdGVnb3J5LzpjYXRlZ29yeUlkJywgdGVzdENvbnRyb2xsZXIuZ2V0UXVlc3Rpb25zQnlDYXRlZ29yeSk7XHJcblxyXG5yb3V0ZXIuZ2V0KCcvY3JlYXRlJywgdGVzdENvbnRyb2xsZXIucmVuZGVyUXVlc3Rpb25MaXN0KTtcclxucm91dGVyLnBvc3QoJy9jcmVhdGUnLCB0ZXN0Q29udHJvbGxlci5jcmVhdGVUZXN0KTtcclxuXHJcbnJvdXRlci5nZXQoJy86aWQnLCB0ZXN0Q29udHJvbGxlci5nZXRUZXN0QnlJZCk7XHJcblxyXG5yb3V0ZXIuZ2V0KCcvJywgdGVzdENvbnRyb2xsZXIuZ2V0QWxsVGVzdHMpO1xyXG5cclxucm91dGVyLmdldCgnL3VwZGF0ZS86aWQnLCB0ZXN0Q29udHJvbGxlci5yZW5kZXJVcGRhdGVUZXN0KTtcclxucm91dGVyLnB1dCgnL3VwZGF0ZS86aWQnLCB0ZXN0Q29udHJvbGxlci51cGRhdGVUZXN0KTtcclxuXHJcbi8vIHJvdXRlci5kZWxldGUoJy86aWQnLCB0ZXN0Q29udHJvbGxlci5kZWxldGVUZXN0KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsY0FBYyxHQUFHSCxPQUFPLENBQUMsK0JBQStCLENBQUM7QUFDL0QsTUFBTUksaUJBQWlCLEdBQUdKLE9BQU8sQ0FBQyxpQ0FBaUMsQ0FBQzs7QUFFcEU7QUFDQUMsTUFBTSxDQUFDSSxHQUFHLENBQUNELGlCQUFpQixDQUFDO0FBRzdCSCxNQUFNLENBQUNLLElBQUksQ0FBQyxpQ0FBaUMsRUFBRUgsY0FBYyxDQUFDSSxzQkFBc0IsQ0FBQztBQUVyRk4sTUFBTSxDQUFDTyxHQUFHLENBQUMsU0FBUyxFQUFFTCxjQUFjLENBQUNNLGtCQUFrQixDQUFDO0FBQ3hEUixNQUFNLENBQUNLLElBQUksQ0FBQyxTQUFTLEVBQUVILGNBQWMsQ0FBQ08sVUFBVSxDQUFDO0FBRWpEVCxNQUFNLENBQUNPLEdBQUcsQ0FBQyxNQUFNLEVBQUVMLGNBQWMsQ0FBQ1EsV0FBVyxDQUFDO0FBRTlDVixNQUFNLENBQUNPLEdBQUcsQ0FBQyxHQUFHLEVBQUVMLGNBQWMsQ0FBQ1MsV0FBVyxDQUFDO0FBRTNDWCxNQUFNLENBQUNPLEdBQUcsQ0FBQyxhQUFhLEVBQUVMLGNBQWMsQ0FBQ1UsZ0JBQWdCLENBQUM7QUFDMURaLE1BQU0sQ0FBQ2EsR0FBRyxDQUFDLGFBQWEsRUFBRVgsY0FBYyxDQUFDWSxVQUFVLENBQUM7O0FBRXBEOztBQUVBQyxNQUFNLENBQUNDLE9BQU8sR0FBR2hCLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","testController","sessionMiddleware","use","post","getQuestionsByCategory","get","renderQuestionList","createTest","getTestById","getAllTests","renderUpdateTest","put","updateTest","module","exports"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\routes\\","sources":["test.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst testController = require('../controllers/testController');\r\nconst sessionMiddleware = require('../middleware/sessionMiddleware');\r\n\r\n// Middleware để kiểm tra session\r\nrouter.use(sessionMiddleware);\r\n\r\n\r\nrouter.post('/questions/category/:categoryId', testController.getQuestionsByCategory);\r\n\r\nrouter.get('/create', testController.renderQuestionList);\r\nrouter.post('/create', testController.createTest);\r\n\r\nrouter.get('/:id', testController.getTestById);\r\n\r\nrouter.get('/', testController.getAllTests);\r\n\r\nrouter.get('/update/:id', testController.renderUpdateTest);\r\nrouter.put('/update/:id', testController.updateTest);\r\n\r\n// router.delete('/:id', testController.deleteTest);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,cAAc,GAAGH,OAAO,CAAC,+BAA+B,CAAC;AAC/D,MAAMI,iBAAiB,GAAGJ,OAAO,CAAC,iCAAiC,CAAC;;AAEpE;AACAC,MAAM,CAACI,GAAG,CAACD,iBAAiB,CAAC;AAG7BH,MAAM,CAACK,IAAI,CAAC,iCAAiC,EAAEH,cAAc,CAACI,sBAAsB,CAAC;AAErFN,MAAM,CAACO,GAAG,CAAC,SAAS,EAAEL,cAAc,CAACM,kBAAkB,CAAC;AACxDR,MAAM,CAACK,IAAI,CAAC,SAAS,EAAEH,cAAc,CAACO,UAAU,CAAC;AAEjDT,MAAM,CAACO,GAAG,CAAC,MAAM,EAAEL,cAAc,CAACQ,WAAW,CAAC;AAE9CV,MAAM,CAACO,GAAG,CAAC,GAAG,EAAEL,cAAc,CAACS,WAAW,CAAC;AAE3CX,MAAM,CAACO,GAAG,CAAC,aAAa,EAAEL,cAAc,CAACU,gBAAgB,CAAC;AAC1DZ,MAAM,CAACa,GAAG,CAAC,aAAa,EAAEX,cAAc,CAACY,UAAU,CAAC;;AAEpD;;AAEAC,MAAM,CAACC,OAAO,GAAGhB,MAAM","ignoreList":[]}},"mtime":1710214092696},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\testController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const mongoose = require('mongoose');\nconst Test = require('../models/Test');\nconst Question = require('../models/question');\nconst Category = require('../models/Category');\nmodule.exports = {\n  renderQuestionList: async (req, res) => {\n    try {\n      const questions = await Question.find();\n      const categories = await Category.find();\n      res.render('test/createTest', {\n        questions,\n        categories\n      });\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  getQuestionsByCategory: async (req, res) => {\n    try {\n      const {\n        categoryId\n      } = req.query;\n      const categoryQuestions = await Question.find({\n        category: categoryId\n      });\n      res.json(categoryQuestions);\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  createTest: async (req, res) => {\n    try {\n      const {\n        name,\n        image,\n        category,\n        questions\n      } = req.body;\n      console.log(\"question: \", questions);\n      const selectedQuestions = [];\n      for (const question of questions) {\n        const foundQuestion = await Question.findOne({\n          content: question\n        });\n        if (foundQuestion) {\n          selectedQuestions.push(foundQuestion._id);\n        }\n      }\n      const newTest = new Test({\n        name,\n        image,\n        category,\n        questions: selectedQuestions\n      });\n      const savedTest = await newTest.save();\n      res.json(savedTest);\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  getTestById: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const test = await Test.findById(id).populate('questions');\n      if (!test) {\n        return res.status(404).json({\n          error: 'Test not found'\n        });\n      }\n      res.json(test);\n    } catch (error) {\n      res.status(500).json({\n        error: error.message\n      });\n    }\n  },\n  getAllTests: async (req, res) => {\n    try {\n      const tests = await Test.find().populate({\n        path: 'questions',\n        populate: {\n          path: 'answers'\n        }\n      }).populate('category');\n      const totalTests = tests.length;\n      const user = req.session.user;\n      res.render('test/getAllTests', {\n        tests,\n        totalTests,\n        user\n      });\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  renderUpdateTest: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const test = await Test.findById(id);\n      const questions = await Question.find();\n      const categories = await Category.find();\n      const user = req.session.user;\n      res.render('test/updateTest', {\n        test,\n        questions,\n        categories,\n        user\n      });\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  },\n  updateTest: async (req, res) => {\n    try {\n      const {\n        id\n      } = req.params;\n      const {\n        name,\n        image,\n        category,\n        questions\n      } = req.body;\n      const selectedQuestions = questions.map(questionId => new mongoose.Types.ObjectId(questionId));\n      const updatedTest = await Test.findByIdAndUpdate(id, {\n        name,\n        image,\n        category,\n        questions: selectedQuestions\n      }, {\n        new: true\n      }).populate('questions');\n      if (!updatedTest) {\n        return res.status(404).json({\n          message: 'Test not found'\n        });\n      }\n      res.json(updatedTest);\n    } catch (error) {\n      res.status(500).json({\n        message: error.message\n      });\n    }\n  }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJUZXN0IiwiUXVlc3Rpb24iLCJDYXRlZ29yeSIsIm1vZHVsZSIsImV4cG9ydHMiLCJyZW5kZXJRdWVzdGlvbkxpc3QiLCJyZXEiLCJyZXMiLCJxdWVzdGlvbnMiLCJmaW5kIiwiY2F0ZWdvcmllcyIsInJlbmRlciIsImVycm9yIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJnZXRRdWVzdGlvbnNCeUNhdGVnb3J5IiwiY2F0ZWdvcnlJZCIsInF1ZXJ5IiwiY2F0ZWdvcnlRdWVzdGlvbnMiLCJjYXRlZ29yeSIsImNyZWF0ZVRlc3QiLCJuYW1lIiwiaW1hZ2UiLCJib2R5IiwiY29uc29sZSIsImxvZyIsInNlbGVjdGVkUXVlc3Rpb25zIiwicXVlc3Rpb24iLCJmb3VuZFF1ZXN0aW9uIiwiZmluZE9uZSIsImNvbnRlbnQiLCJwdXNoIiwiX2lkIiwibmV3VGVzdCIsInNhdmVkVGVzdCIsInNhdmUiLCJnZXRUZXN0QnlJZCIsImlkIiwicGFyYW1zIiwidGVzdCIsImZpbmRCeUlkIiwicG9wdWxhdGUiLCJnZXRBbGxUZXN0cyIsInRlc3RzIiwicGF0aCIsInRvdGFsVGVzdHMiLCJsZW5ndGgiLCJ1c2VyIiwic2Vzc2lvbiIsInJlbmRlclVwZGF0ZVRlc3QiLCJ1cGRhdGVUZXN0IiwibWFwIiwicXVlc3Rpb25JZCIsIlR5cGVzIiwiT2JqZWN0SWQiLCJ1cGRhdGVkVGVzdCIsImZpbmRCeUlkQW5kVXBkYXRlIiwibmV3Il0sInNvdXJjZVJvb3QiOiJHOlxcVFRUTl9TUDI0X1NFUlZFUlxcY29udHJvbGxlcnNcXCIsInNvdXJjZXMiOlsidGVzdENvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xyXG5jb25zdCBUZXN0ID0gcmVxdWlyZSgnLi4vbW9kZWxzL1Rlc3QnKTtcclxuY29uc3QgUXVlc3Rpb24gPSByZXF1aXJlKCcuLi9tb2RlbHMvcXVlc3Rpb24nKTtcclxuY29uc3QgQ2F0ZWdvcnkgPSByZXF1aXJlKCcuLi9tb2RlbHMvQ2F0ZWdvcnknKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgcmVuZGVyUXVlc3Rpb25MaXN0OiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBxdWVzdGlvbnMgPSBhd2FpdCBRdWVzdGlvbi5maW5kKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBDYXRlZ29yeS5maW5kKCk7XHJcbiAgICAgICAgICAgIHJlcy5yZW5kZXIoJ3Rlc3QvY3JlYXRlVGVzdCcsIHsgcXVlc3Rpb25zLCBjYXRlZ29yaWVzIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFF1ZXN0aW9uc0J5Q2F0ZWdvcnk6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgY2F0ZWdvcnlJZCB9ID0gcmVxLnF1ZXJ5O1xyXG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yeVF1ZXN0aW9ucyA9IGF3YWl0IFF1ZXN0aW9uLmZpbmQoeyBjYXRlZ29yeTogY2F0ZWdvcnlJZCB9KTtcclxuICAgICAgICAgICAgcmVzLmpzb24oY2F0ZWdvcnlRdWVzdGlvbnMpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0ZVRlc3Q6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSwgaW1hZ2UsIGNhdGVnb3J5LCBxdWVzdGlvbnMgfSA9IHJlcS5ib2R5OyBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJxdWVzdGlvbjogXCIsIHF1ZXN0aW9ucyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFF1ZXN0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHF1ZXN0aW9uIG9mIHF1ZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZm91bmRRdWVzdGlvbiA9IGF3YWl0IFF1ZXN0aW9uLmZpbmRPbmUoeyBjb250ZW50OiBxdWVzdGlvbiB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChmb3VuZFF1ZXN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRRdWVzdGlvbnMucHVzaChmb3VuZFF1ZXN0aW9uLl9pZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1Rlc3QgPSBuZXcgVGVzdCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgaW1hZ2UsXHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeSxcclxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uczogc2VsZWN0ZWRRdWVzdGlvbnMsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBzYXZlZFRlc3QgPSBhd2FpdCBuZXdUZXN0LnNhdmUoKTtcclxuICAgICAgICAgICAgcmVzLmpzb24oc2F2ZWRUZXN0KTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBnZXRUZXN0QnlJZDogYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcclxuICAgICAgICAgICAgY29uc3QgdGVzdCA9IGF3YWl0IFRlc3QuZmluZEJ5SWQoaWQpLnBvcHVsYXRlKCdxdWVzdGlvbnMnKTtcclxuICAgICAgICAgICAgaWYgKCF0ZXN0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1Rlc3Qgbm90IGZvdW5kJyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXMuanNvbih0ZXN0KTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgZ2V0QWxsVGVzdHM6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3RzID0gYXdhaXQgVGVzdC5maW5kKCkucG9wdWxhdGUoe1xyXG4gICAgICAgICAgICAgICAgcGF0aDogJ3F1ZXN0aW9ucycsXHJcbiAgICAgICAgICAgICAgICBwb3B1bGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6ICdhbnN3ZXJzJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KS5wb3B1bGF0ZSgnY2F0ZWdvcnknKTtcclxuICAgICAgICAgICAgY29uc3QgdG90YWxUZXN0cyA9IHRlc3RzLmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IHJlcS5zZXNzaW9uLnVzZXI7XHJcbiAgICAgICAgICAgIHJlcy5yZW5kZXIoJ3Rlc3QvZ2V0QWxsVGVzdHMnLCB7IHRlc3RzLCB0b3RhbFRlc3RzLCB1c2VyIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbmRlclVwZGF0ZVRlc3Q6IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlc3QgPSBhd2FpdCBUZXN0LmZpbmRCeUlkKGlkKTtcclxuICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25zID0gYXdhaXQgUXVlc3Rpb24uZmluZCgpO1xyXG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yaWVzID0gYXdhaXQgQ2F0ZWdvcnkuZmluZCgpO1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICAgICAgcmVzLnJlbmRlcigndGVzdC91cGRhdGVUZXN0JywgeyB0ZXN0LCBxdWVzdGlvbnMsIGNhdGVnb3JpZXMsIHVzZXIgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1cGRhdGVUZXN0OiBhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xyXG4gICAgICAgICAgICBjb25zdCB7IG5hbWUsIGltYWdlLCBjYXRlZ29yeSwgcXVlc3Rpb25zIH0gPSByZXEuYm9keTtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRRdWVzdGlvbnMgPSBxdWVzdGlvbnMubWFwKHF1ZXN0aW9uSWQgPT4gbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHF1ZXN0aW9uSWQpKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRUZXN0ID0gYXdhaXQgVGVzdC5maW5kQnlJZEFuZFVwZGF0ZShcclxuICAgICAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICAgICAgeyBuYW1lLCBpbWFnZSwgY2F0ZWdvcnksIHF1ZXN0aW9uczogc2VsZWN0ZWRRdWVzdGlvbnMgfSxcclxuICAgICAgICAgICAgICAgIHsgbmV3OiB0cnVlIH1cclxuICAgICAgICAgICAgKS5wb3B1bGF0ZSgncXVlc3Rpb25zJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIXVwZGF0ZWRUZXN0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnVGVzdCBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXMuanNvbih1cGRhdGVkVGVzdCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3BDLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLGdCQUFnQixDQUFDO0FBQ3RDLE1BQU1FLFFBQVEsR0FBR0YsT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBQzlDLE1BQU1HLFFBQVEsR0FBR0gsT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBRTlDSSxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUNiQyxrQkFBa0IsRUFBRSxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNwQyxJQUFJO01BQ0EsTUFBTUMsU0FBUyxHQUFHLE1BQU1QLFFBQVEsQ0FBQ1EsSUFBSSxDQUFDLENBQUM7TUFDdkMsTUFBTUMsVUFBVSxHQUFHLE1BQU1SLFFBQVEsQ0FBQ08sSUFBSSxDQUFDLENBQUM7TUFDeENGLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLGlCQUFpQixFQUFFO1FBQUVILFNBQVM7UUFBRUU7TUFBVyxDQUFDLENBQUM7SUFDNUQsQ0FBQyxDQUFDLE9BQU9FLEtBQUssRUFBRTtNQUNaTCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQUVDLE9BQU8sRUFBRUgsS0FBSyxDQUFDRztNQUFRLENBQUMsQ0FBQztJQUNwRDtFQUNKLENBQUM7RUFFREMsc0JBQXNCLEVBQUUsTUFBQUEsQ0FBT1YsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDeEMsSUFBSTtNQUNBLE1BQU07UUFBRVU7TUFBVyxDQUFDLEdBQUdYLEdBQUcsQ0FBQ1ksS0FBSztNQUNoQyxNQUFNQyxpQkFBaUIsR0FBRyxNQUFNbEIsUUFBUSxDQUFDUSxJQUFJLENBQUM7UUFBRVcsUUFBUSxFQUFFSDtNQUFXLENBQUMsQ0FBQztNQUN2RVYsR0FBRyxDQUFDTyxJQUFJLENBQUNLLGlCQUFpQixDQUFDO0lBQy9CLENBQUMsQ0FBQyxPQUFPUCxLQUFLLEVBQUU7TUFDWkwsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUVILEtBQUssQ0FBQ0c7TUFBUSxDQUFDLENBQUM7SUFDcEQ7RUFDSixDQUFDO0VBRURNLFVBQVUsRUFBRSxNQUFBQSxDQUFPZixHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUM1QixJQUFJO01BQ0EsTUFBTTtRQUFFZSxJQUFJO1FBQUVDLEtBQUs7UUFBRUgsUUFBUTtRQUFFWjtNQUFVLENBQUMsR0FBR0YsR0FBRyxDQUFDa0IsSUFBSTtNQUNyREMsT0FBTyxDQUFDQyxHQUFHLENBQUMsWUFBWSxFQUFFbEIsU0FBUyxDQUFDO01BRXBDLE1BQU1tQixpQkFBaUIsR0FBRyxFQUFFO01BQzVCLEtBQUssTUFBTUMsUUFBUSxJQUFJcEIsU0FBUyxFQUFFO1FBQzlCLE1BQU1xQixhQUFhLEdBQUcsTUFBTTVCLFFBQVEsQ0FBQzZCLE9BQU8sQ0FBQztVQUFFQyxPQUFPLEVBQUVIO1FBQVMsQ0FBQyxDQUFDO1FBQ25FLElBQUlDLGFBQWEsRUFBRTtVQUNmRixpQkFBaUIsQ0FBQ0ssSUFBSSxDQUFDSCxhQUFhLENBQUNJLEdBQUcsQ0FBQztRQUM3QztNQUNKO01BRUEsTUFBTUMsT0FBTyxHQUFHLElBQUlsQyxJQUFJLENBQUM7UUFDckJzQixJQUFJO1FBQ0pDLEtBQUs7UUFDTEgsUUFBUTtRQUNSWixTQUFTLEVBQUVtQjtNQUNmLENBQUMsQ0FBQztNQUNGLE1BQU1RLFNBQVMsR0FBRyxNQUFNRCxPQUFPLENBQUNFLElBQUksQ0FBQyxDQUFDO01BQ3RDN0IsR0FBRyxDQUFDTyxJQUFJLENBQUNxQixTQUFTLENBQUM7SUFDdkIsQ0FBQyxDQUFDLE9BQU92QixLQUFLLEVBQUU7TUFDWkwsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUVILEtBQUssQ0FBQ0c7TUFBUSxDQUFDLENBQUM7SUFDcEQ7RUFDSixDQUFDO0VBRURzQixXQUFXLEVBQUUsTUFBQUEsQ0FBTy9CLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQzdCLElBQUk7TUFDQSxNQUFNO1FBQUUrQjtNQUFHLENBQUMsR0FBR2hDLEdBQUcsQ0FBQ2lDLE1BQU07TUFDekIsTUFBTUMsSUFBSSxHQUFHLE1BQU14QyxJQUFJLENBQUN5QyxRQUFRLENBQUNILEVBQUUsQ0FBQyxDQUFDSSxRQUFRLENBQUMsV0FBVyxDQUFDO01BQzFELElBQUksQ0FBQ0YsSUFBSSxFQUFFO1FBQ1AsT0FBT2pDLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRUYsS0FBSyxFQUFFO1FBQWlCLENBQUMsQ0FBQztNQUM1RDtNQUNBTCxHQUFHLENBQUNPLElBQUksQ0FBQzBCLElBQUksQ0FBQztJQUNsQixDQUFDLENBQUMsT0FBTzVCLEtBQUssRUFBRTtNQUNaTCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQUVGLEtBQUssRUFBRUEsS0FBSyxDQUFDRztNQUFRLENBQUMsQ0FBQztJQUNsRDtFQUNKLENBQUM7RUFFRDRCLFdBQVcsRUFBRSxNQUFBQSxDQUFPckMsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDN0IsSUFBSTtNQUNBLE1BQU1xQyxLQUFLLEdBQUcsTUFBTTVDLElBQUksQ0FBQ1MsSUFBSSxDQUFDLENBQUMsQ0FBQ2lDLFFBQVEsQ0FBQztRQUNyQ0csSUFBSSxFQUFFLFdBQVc7UUFDakJILFFBQVEsRUFBRTtVQUNORyxJQUFJLEVBQUU7UUFDVjtNQUNKLENBQUMsQ0FBQyxDQUFDSCxRQUFRLENBQUMsVUFBVSxDQUFDO01BQ3ZCLE1BQU1JLFVBQVUsR0FBR0YsS0FBSyxDQUFDRyxNQUFNO01BQy9CLE1BQU1DLElBQUksR0FBRzFDLEdBQUcsQ0FBQzJDLE9BQU8sQ0FBQ0QsSUFBSTtNQUM3QnpDLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDLGtCQUFrQixFQUFFO1FBQUVpQyxLQUFLO1FBQUVFLFVBQVU7UUFBRUU7TUFBSyxDQUFDLENBQUM7SUFDL0QsQ0FBQyxDQUFDLE9BQU9wQyxLQUFLLEVBQUU7TUFDWkwsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUVILEtBQUssQ0FBQ0c7TUFBUSxDQUFDLENBQUM7SUFDcEQ7RUFDSixDQUFDO0VBRURtQyxnQkFBZ0IsRUFBRSxNQUFBQSxDQUFPNUMsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbEMsSUFBSTtNQUNBLE1BQU07UUFBRStCO01BQUcsQ0FBQyxHQUFHaEMsR0FBRyxDQUFDaUMsTUFBTTtNQUN6QixNQUFNQyxJQUFJLEdBQUcsTUFBTXhDLElBQUksQ0FBQ3lDLFFBQVEsQ0FBQ0gsRUFBRSxDQUFDO01BQ3BDLE1BQU05QixTQUFTLEdBQUcsTUFBTVAsUUFBUSxDQUFDUSxJQUFJLENBQUMsQ0FBQztNQUN2QyxNQUFNQyxVQUFVLEdBQUcsTUFBTVIsUUFBUSxDQUFDTyxJQUFJLENBQUMsQ0FBQztNQUN4QyxNQUFNdUMsSUFBSSxHQUFHMUMsR0FBRyxDQUFDMkMsT0FBTyxDQUFDRCxJQUFJO01BQzdCekMsR0FBRyxDQUFDSSxNQUFNLENBQUMsaUJBQWlCLEVBQUU7UUFBRTZCLElBQUk7UUFBRWhDLFNBQVM7UUFBRUUsVUFBVTtRQUFFc0M7TUFBSyxDQUFDLENBQUM7SUFDeEUsQ0FBQyxDQUFDLE9BQU9wQyxLQUFLLEVBQUU7TUFDWkwsR0FBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFQyxPQUFPLEVBQUVILEtBQUssQ0FBQ0c7TUFBUSxDQUFDLENBQUM7SUFDcEQ7RUFDSixDQUFDO0VBQ0RvQyxVQUFVLEVBQUUsTUFBQUEsQ0FBTzdDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQzVCLElBQUk7TUFDQSxNQUFNO1FBQUUrQjtNQUFHLENBQUMsR0FBR2hDLEdBQUcsQ0FBQ2lDLE1BQU07TUFDekIsTUFBTTtRQUFFakIsSUFBSTtRQUFFQyxLQUFLO1FBQUVILFFBQVE7UUFBRVo7TUFBVSxDQUFDLEdBQUdGLEdBQUcsQ0FBQ2tCLElBQUk7TUFDckQsTUFBTUcsaUJBQWlCLEdBQUduQixTQUFTLENBQUM0QyxHQUFHLENBQUNDLFVBQVUsSUFBSSxJQUFJdkQsUUFBUSxDQUFDd0QsS0FBSyxDQUFDQyxRQUFRLENBQUNGLFVBQVUsQ0FBQyxDQUFDO01BRTlGLE1BQU1HLFdBQVcsR0FBRyxNQUFNeEQsSUFBSSxDQUFDeUQsaUJBQWlCLENBQzVDbkIsRUFBRSxFQUNGO1FBQUVoQixJQUFJO1FBQUVDLEtBQUs7UUFBRUgsUUFBUTtRQUFFWixTQUFTLEVBQUVtQjtNQUFrQixDQUFDLEVBQ3ZEO1FBQUUrQixHQUFHLEVBQUU7TUFBSyxDQUNoQixDQUFDLENBQUNoQixRQUFRLENBQUMsV0FBVyxDQUFDO01BRXZCLElBQUksQ0FBQ2MsV0FBVyxFQUFFO1FBQ2QsT0FBT2pELEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRUMsT0FBTyxFQUFFO1FBQWlCLENBQUMsQ0FBQztNQUM5RDtNQUVBUixHQUFHLENBQUNPLElBQUksQ0FBQzBDLFdBQVcsQ0FBQztJQUN6QixDQUFDLENBQUMsT0FBTzVDLEtBQUssRUFBRTtNQUNaTCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQUVDLE9BQU8sRUFBRUgsS0FBSyxDQUFDRztNQUFRLENBQUMsQ0FBQztJQUNwRDtFQUNKO0FBQ0osQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["mongoose","require","Test","Question","Category","module","exports","renderQuestionList","req","res","questions","find","categories","render","error","status","json","message","getQuestionsByCategory","categoryId","query","categoryQuestions","category","createTest","name","image","body","console","log","selectedQuestions","question","foundQuestion","findOne","content","push","_id","newTest","savedTest","save","getTestById","id","params","test","findById","populate","getAllTests","tests","path","totalTests","length","user","session","renderUpdateTest","updateTest","map","questionId","Types","ObjectId","updatedTest","findByIdAndUpdate","new"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\controllers\\","sources":["testController.js"],"sourcesContent":["const mongoose = require('mongoose');\r\nconst Test = require('../models/Test');\r\nconst Question = require('../models/question');\r\nconst Category = require('../models/Category');\r\n\r\nmodule.exports = {\r\n    renderQuestionList: async (req, res) => {\r\n        try {\r\n            const questions = await Question.find();\r\n            const categories = await Category.find();\r\n            res.render('test/createTest', { questions, categories });\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n    getQuestionsByCategory: async (req, res) => {\r\n        try {\r\n            const { categoryId } = req.query;\r\n            const categoryQuestions = await Question.find({ category: categoryId });\r\n            res.json(categoryQuestions);\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n    createTest: async (req, res) => {\r\n        try {\r\n            const { name, image, category, questions } = req.body; \r\n            console.log(\"question: \", questions);\r\n\r\n            const selectedQuestions = [];\r\n            for (const question of questions) {\r\n                const foundQuestion = await Question.findOne({ content: question });\r\n                if (foundQuestion) {\r\n                    selectedQuestions.push(foundQuestion._id);\r\n                }\r\n            }\r\n\r\n            const newTest = new Test({\r\n                name,\r\n                image,\r\n                category,\r\n                questions: selectedQuestions,\r\n            });\r\n            const savedTest = await newTest.save();\r\n            res.json(savedTest);\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n    getTestById: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            const test = await Test.findById(id).populate('questions');\r\n            if (!test) {\r\n                return res.status(404).json({ error: 'Test not found' });\r\n            }\r\n            res.json(test);\r\n        } catch (error) {\r\n            res.status(500).json({ error: error.message });\r\n        }\r\n    },\r\n\r\n    getAllTests: async (req, res) => {\r\n        try {\r\n            const tests = await Test.find().populate({\r\n                path: 'questions',\r\n                populate: {\r\n                    path: 'answers'\r\n                }\r\n            }).populate('category');\r\n            const totalTests = tests.length;\r\n            const user = req.session.user;\r\n            res.render('test/getAllTests', { tests, totalTests, user });\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n\r\n    renderUpdateTest: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            const test = await Test.findById(id);\r\n            const questions = await Question.find();\r\n            const categories = await Category.find();\r\n            const user = req.session.user;\r\n            res.render('test/updateTest', { test, questions, categories, user });\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n    updateTest: async (req, res) => {\r\n        try {\r\n            const { id } = req.params;\r\n            const { name, image, category, questions } = req.body;\r\n            const selectedQuestions = questions.map(questionId => new mongoose.Types.ObjectId(questionId));\r\n\r\n            const updatedTest = await Test.findByIdAndUpdate(\r\n                id,\r\n                { name, image, category, questions: selectedQuestions },\r\n                { new: true }\r\n            ).populate('questions');\r\n\r\n            if (!updatedTest) {\r\n                return res.status(404).json({ message: 'Test not found' });\r\n            }\r\n\r\n            res.json(updatedTest);\r\n        } catch (error) {\r\n            res.status(500).json({ message: error.message });\r\n        }\r\n    },\r\n};\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1710838700176},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\models\\\\Test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const mongoose = require('mongoose');\nconst TestSchema = new mongoose.Schema({\n  name: {\n    type: String,\n    required: true\n  },\n  image: {\n    type: String,\n    require: true\n  },\n  category: {\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'Category',\n    required: true\n  },\n  questions: [{\n    type: mongoose.Schema.Types.ObjectId,\n    ref: 'Question'\n  }]\n});\nmodule.exports = mongoose.model('Test', TestSchema);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJUZXN0U2NoZW1hIiwiU2NoZW1hIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsImltYWdlIiwiY2F0ZWdvcnkiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwicXVlc3Rpb25zIiwibW9kdWxlIiwiZXhwb3J0cyIsIm1vZGVsIl0sInNvdXJjZVJvb3QiOiJHOlxcVFRUTl9TUDI0X1NFUlZFUlxcbW9kZWxzXFwiLCJzb3VyY2VzIjpbIlRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xyXG5cclxuY29uc3QgVGVzdFNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xyXG4gIG5hbWU6IHtcclxuICAgIHR5cGU6IFN0cmluZyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gIH0sXHJcbiAgaW1hZ2U6e1xyXG4gICAgdHlwZTogU3RyaW5nLFxyXG4gICAgcmVxdWlyZTogdHJ1ZSxcclxuICB9LFxyXG4gIGNhdGVnb3J5OiB7XHJcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXHJcbiAgICByZWY6ICdDYXRlZ29yeScsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICB9LFxyXG4gIHF1ZXN0aW9uczogW3tcclxuICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcclxuICAgIHJlZjogJ1F1ZXN0aW9uJywgXHJcbiAgfV0sXHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbCgnVGVzdCcsIFRlc3RTY2hlbWEpO1xyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUVwQyxNQUFNQyxVQUFVLEdBQUcsSUFBSUYsUUFBUSxDQUFDRyxNQUFNLENBQUM7RUFDckNDLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxLQUFLLEVBQUM7SUFDSkgsSUFBSSxFQUFFQyxNQUFNO0lBQ1pMLE9BQU8sRUFBRTtFQUNYLENBQUM7RUFDRFEsUUFBUSxFQUFFO0lBQ1JKLElBQUksRUFBRUwsUUFBUSxDQUFDRyxNQUFNLENBQUNPLEtBQUssQ0FBQ0MsUUFBUTtJQUNwQ0MsR0FBRyxFQUFFLFVBQVU7SUFDZkwsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxTQUFTLEVBQUUsQ0FBQztJQUNWUixJQUFJLEVBQUVMLFFBQVEsQ0FBQ0csTUFBTSxDQUFDTyxLQUFLLENBQUNDLFFBQVE7SUFDcENDLEdBQUcsRUFBRTtFQUNQLENBQUM7QUFDSCxDQUFDLENBQUM7QUFFRkUsTUFBTSxDQUFDQyxPQUFPLEdBQUdmLFFBQVEsQ0FBQ2dCLEtBQUssQ0FBQyxNQUFNLEVBQUVkLFVBQVUsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["mongoose","require","TestSchema","Schema","name","type","String","required","image","category","Types","ObjectId","ref","questions","module","exports","model"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\models\\","sources":["Test.js"],"sourcesContent":["const mongoose = require('mongoose');\r\n\r\nconst TestSchema = new mongoose.Schema({\r\n  name: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  image:{\r\n    type: String,\r\n    require: true,\r\n  },\r\n  category: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'Category',\r\n    required: true,\r\n  },\r\n  questions: [{\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'Question', \r\n  }],\r\n});\r\n\r\nmodule.exports = mongoose.model('Test', TestSchema);\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AAEpC,MAAMC,UAAU,GAAG,IAAIF,QAAQ,CAACG,MAAM,CAAC;EACrCC,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,KAAK,EAAC;IACJH,IAAI,EAAEC,MAAM;IACZL,OAAO,EAAE;EACX,CAAC;EACDQ,QAAQ,EAAE;IACRJ,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACO,KAAK,CAACC,QAAQ;IACpCC,GAAG,EAAE,UAAU;IACfL,QAAQ,EAAE;EACZ,CAAC;EACDM,SAAS,EAAE,CAAC;IACVR,IAAI,EAAEL,QAAQ,CAACG,MAAM,CAACO,KAAK,CAACC,QAAQ;IACpCC,GAAG,EAAE;EACP,CAAC;AACH,CAAC,CAAC;AAEFE,MAAM,CAACC,OAAO,GAAGf,QAAQ,CAACgB,KAAK,CAAC,MAAM,EAAEd,UAAU,CAAC","ignoreList":[]}},"mtime":1710838700180},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\routes\\\\nft.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst nftController = require('../controllers/nftController');\nrouter.post('/createNFT', nftController.createNFT);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIm5mdENvbnRyb2xsZXIiLCJwb3N0IiwiY3JlYXRlTkZUIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiRzpcXFRUVE5fU1AyNF9TRVJWRVJcXHJvdXRlc1xcIiwic291cmNlcyI6WyJuZnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgbmZ0Q29udHJvbGxlciA9IHJlcXVpcmUoJy4uL2NvbnRyb2xsZXJzL25mdENvbnRyb2xsZXInKTtcclxuXHJcbnJvdXRlci5wb3N0KCcvY3JlYXRlTkZUJywgbmZ0Q29udHJvbGxlci5jcmVhdGVORlQpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFNLENBQUMsQ0FBQztBQUMvQixNQUFNQyxhQUFhLEdBQUdILE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQztBQUU3REMsTUFBTSxDQUFDRyxJQUFJLENBQUMsWUFBWSxFQUFFRCxhQUFhLENBQUNFLFNBQVMsQ0FBQztBQUVsREMsTUFBTSxDQUFDQyxPQUFPLEdBQUdOLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","nftController","post","createNFT","module","exports"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\routes\\","sources":["nft.js"],"sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst nftController = require('../controllers/nftController');\r\n\r\nrouter.post('/createNFT', nftController.createNFT);\r\n\r\nmodule.exports = router;\r\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,aAAa,GAAGH,OAAO,CAAC,8BAA8B,CAAC;AAE7DC,MAAM,CAACG,IAAI,CAAC,YAAY,EAAED,aAAa,CAACE,SAAS,CAAC;AAElDC,MAAM,CAACC,OAAO,GAAGN,MAAM","ignoreList":[]}},"mtime":1711640219002},"{\"assumptions\":{},\"sourceRoot\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"G:\\\\TTTN_SP24_SERVER\",\"filename\":\"G:\\\\TTTN_SP24_SERVER\\\\controllers\\\\nftController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"G:\\\\TTTN_SP24_SERVER\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.3:development":{"value":{"code":"import fetch from \"node-fetch\";\nexports.createNFT = async (req, res) => {\n  try {\n    const response = await fetch('https://api.shyft.to/nft', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer accessToken'\n      },\n      body: JSON.stringify(req.body)\n    });\n    const responseData = await response.json();\n    res.json(responseData);\n  } catch (error) {\n    console.error('Failed to create NFT:', error);\n    res.status(500).json({\n      error: 'Failed to create NFT'\n    });\n  }\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmZXRjaCIsImV4cG9ydHMiLCJjcmVhdGVORlQiLCJyZXEiLCJyZXMiLCJyZXNwb25zZSIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlc3BvbnNlRGF0YSIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6Ikc6XFxUVFROX1NQMjRfU0VSVkVSXFxjb250cm9sbGVyc1xcIiwic291cmNlcyI6WyJuZnRDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmZXRjaCAgZnJvbSBcIm5vZGUtZmV0Y2hcIjtcclxuXHJcbmV4cG9ydHMuY3JlYXRlTkZUID0gYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLnNoeWZ0LnRvL25mdCcsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgYWNjZXNzVG9rZW4nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcS5ib2R5KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICByZXMuanNvbihyZXNwb25zZURhdGEpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIE5GVDonLCBlcnJvcik7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgTkZUJyB9KTtcclxuICAgIH1cclxufTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxLQUFLLE1BQU8sWUFBWTtBQUUvQkMsT0FBTyxDQUFDQyxTQUFTLEdBQUcsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDcEMsSUFBSTtJQUNBLE1BQU1DLFFBQVEsR0FBRyxNQUFNTCxLQUFLLENBQUMsMEJBQTBCLEVBQUU7TUFDckRNLE1BQU0sRUFBRSxNQUFNO01BQ2RDLE9BQU8sRUFBRTtRQUNMLGNBQWMsRUFBRSxrQkFBa0I7UUFDbEMsZUFBZSxFQUFFO01BQ3JCLENBQUM7TUFDREMsSUFBSSxFQUFFQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ1AsR0FBRyxDQUFDSyxJQUFJO0lBQ2pDLENBQUMsQ0FBQztJQUNGLE1BQU1HLFlBQVksR0FBRyxNQUFNTixRQUFRLENBQUNPLElBQUksQ0FBQyxDQUFDO0lBQzFDUixHQUFHLENBQUNRLElBQUksQ0FBQ0QsWUFBWSxDQUFDO0VBQzFCLENBQUMsQ0FBQyxPQUFPRSxLQUFLLEVBQUU7SUFDWkMsT0FBTyxDQUFDRCxLQUFLLENBQUMsdUJBQXVCLEVBQUVBLEtBQUssQ0FBQztJQUM3Q1QsR0FBRyxDQUFDVyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNILElBQUksQ0FBQztNQUFFQyxLQUFLLEVBQUU7SUFBdUIsQ0FBQyxDQUFDO0VBQzNEO0FBQ0osQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["fetch","exports","createNFT","req","res","response","method","headers","body","JSON","stringify","responseData","json","error","console","status"],"sourceRoot":"G:\\TTTN_SP24_SERVER\\controllers\\","sources":["nftController.js"],"sourcesContent":["import fetch  from \"node-fetch\";\r\n\r\nexports.createNFT = async (req, res) => {\r\n    try {\r\n        const response = await fetch('https://api.shyft.to/nft', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': 'Bearer accessToken'\r\n            },\r\n            body: JSON.stringify(req.body)\r\n        });\r\n        const responseData = await response.json();\r\n        res.json(responseData);\r\n    } catch (error) {\r\n        console.error('Failed to create NFT:', error);\r\n        res.status(500).json({ error: 'Failed to create NFT' });\r\n    }\r\n};\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAO,YAAY;AAE/BC,OAAO,CAACC,SAAS,GAAG,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACpC,IAAI;IACA,MAAMC,QAAQ,GAAG,MAAML,KAAK,CAAC,0BAA0B,EAAE;MACrDM,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClC,eAAe,EAAE;MACrB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,GAAG,CAACK,IAAI;IACjC,CAAC,CAAC;IACF,MAAMG,YAAY,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;IAC1CR,GAAG,CAACQ,IAAI,CAACD,YAAY,CAAC;EAC1B,CAAC,CAAC,OAAOE,KAAK,EAAE;IACZC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IAC7CT,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACH,IAAI,CAAC;MAAEC,KAAK,EAAE;IAAuB,CAAC,CAAC;EAC3D;AACJ,CAAC","ignoreList":[]}},"mtime":1711640400689}}